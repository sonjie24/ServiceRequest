{
  "name": "Service Request v2",
  "nodes": [
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 519366898,
          "mode": "list",
          "cachedResultName": "Details",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=519366898"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "MainGUID",
              "lookupValue": "={{ $json.body.uuid }}"
            }
          ]
        },
        "options": {
          "returnFirstMatch": true
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -1136,
        -2944
      ],
      "id": "75e3c9ff-d626-4c10-a448-30f2c676ae3a",
      "name": "get detail",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "delete",
        "responseMode": "responseNode",
        "options": {
          "binaryPropertyName": "data"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1376,
        -2944
      ],
      "id": "3f25e319-a1bd-4be1-9c7f-65ef2fb7a01a",
      "name": "Webhook",
      "webhookId": "659f7f10-403f-4279-8469-23426b2172c6"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        -720,
        -2944
      ],
      "id": "ad0fa7d5-0c21-4f07-a714-d98aa016c783",
      "name": "Respond to Webhook1"
    },
    {
      "parameters": {
        "operation": "delete",
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 519366898,
          "mode": "list",
          "cachedResultName": "Details",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=519366898"
        },
        "startIndex": "={{ $json.row_number }}"
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -944,
        -2944
      ],
      "id": "035a29f3-c884-404b-a6cf-a84b9cc2de4f",
      "name": "Delete rows or columns from sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "content": "## REMOVE DETAIL \n**Double click** to edit me. [Guide](https://docs.n8n.io/workflows/sticky-notes/)",
        "height": 304,
        "width": 1152
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1632,
        -3008
      ],
      "typeVersion": 1,
      "id": "7b196ede-ba35-443a-9fc3-48cac6b0b767",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "={{ $json.body.uuid }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "1CfC_EqMaOBqNwvCe3TjOqzp25u61swcf",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1CfC_EqMaOBqNwvCe3TjOqzp25u61swcf"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -800,
        -4976
      ],
      "id": "7a459dfb-0b65-404e-8498-1f59bc2219ea",
      "name": "Create folder",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Lm749rdsnAHcpKnx",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -592,
        -5232
      ],
      "id": "4126ba3f-cc04-4b8f-b8a2-f5fdf9742556",
      "name": "Merge3"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1440184445,
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1440184445"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "project",
              "lookupValue": "={{ $json.body.project }}"
            },
            {
              "lookupColumn": "project",
              "lookupValue": "All"
            }
          ]
        },
        "combineFilters": "OR",
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -1168,
        -5296
      ],
      "id": "8c5818fe-a795-48c8-9909-cd1984e4fccc",
      "name": "Get Last Reference1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const projectCode = $input.first().json.project || 'CBMIS';\n\n// Get current year and month (2 digits)\nconst now = new Date();\nconst year = now.getFullYear(); // e.g. 2025\nconst month = String(now.getMonth() + 1).padStart(2, '0'); // e.g. 08\n\n// Get the last row from previous items (e.g., from Google Sheets)\nconst lastRow = items.length > 0 ? items[items.length - 1] : null;\n\nlet lastRef = null;\nif (lastRow && lastRow.json && lastRow.json['service_request_no']) {\n  lastRef = lastRow.json['service_request_no'];\n}\n\nlet newRef = `${projectCode}-${year}-${month}-0001`; // default if nothing found\n\nif (typeof lastRef === 'string') {\n  const regex = new RegExp(`^${projectCode}-\\\\d{4}-\\\\d{2}-\\\\d+$`);\n  if (regex.test(lastRef)) {\n    const parts = lastRef.split('-'); // ['CBMIS', '2025', '07', '0012']\n    const prefix = `${projectCode}-${year}-${month}`; \n\n    if (parts[1] === year.toString()) {\n      // Increment if same YEAR\n      const nextNum = parseInt(parts[3], 10) + 1;\n      const padded = nextNum.toString().padStart(4, '0');\n      newRef = `${prefix}-${padded}`;\n    } else {\n      // Reset to 0001 if YEAR changed\n      newRef = `${prefix}-0001`;\n    }\n  }\n}\n\nconst data = $('Extract Form Text').first().json.data || {};\ndata.service_request_no = newRef;\n\nreturn [{ json: data }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -400,
        -5232
      ],
      "id": "ca82a257-a801-4840-8adf-f46f9486331e",
      "name": "Generate New Reference1"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1440184445,
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1440184445"
        },
        "columns": {
          "mappingMode": "autoMapInputData",
          "value": {
            "id": "==row()-1",
            "project": "={{ $json.project }}",
            "date_requested": "={{ $json.date_requested }}",
            "service_request_no": "={{ $json.service_request_no }}",
            "department": "={{ $json.department }}",
            "module": "={{ $json.module }}",
            "system_form_name": "={{ $json.system_form_name }}",
            "concern_type_new": "={{ $json.concern_type_new }}",
            "concern_type_rev": "={{ $json.concern_type_rev }}",
            "concern_type_del": "={{ $json.concern_type_del }}",
            "concern_type_cos": "={{ $json.concern_type_cos }}",
            "priority_set": "={{ $json.priority_set }}",
            "committed_date": "={{ $json.committed_date }}",
            "priority_immediate": "={{ $json.priority_immediate }}",
            "priority_add": "={{ $json.priority_add }}",
            "user": "={{ $json.user }}",
            "department_head": "={{ $json.department_head }}",
            "it_head": "={{ $json.it_head }}",
            "integrator": "={{ $json.integrator }}",
            "developer": "={{ $json.developer }}",
            "qa": "={{ $json.qa }}",
            "print_option_as_req": "={{ $json.print_option_as_req }}",
            "print_out_date": "={{ $json.print_out_date }}",
            "print_option_sys_print": "={{ $json.print_option_sys_print }}",
            "system_print_date": "={{ $json.system_print_date }}",
            "print_option_modified": "={{ $json.print_option_modified }}",
            "patch_date": "={{ $json.patch_date }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "type",
              "displayName": "type",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "uuid",
              "displayName": "uuid",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "project",
              "displayName": "project",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "date_requested",
              "displayName": "date_requested",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "service_request_no",
              "displayName": "service_request_no",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "req_status",
              "displayName": "req_status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "cylix_status",
              "displayName": "cylix_status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "dev_status",
              "displayName": "dev_status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "department",
              "displayName": "department",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "module",
              "displayName": "module",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "system_form_no",
              "displayName": "system_form_no",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "system_form_name",
              "displayName": "system_form_name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "memo",
              "displayName": "memo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "concern_type_new",
              "displayName": "concern_type_new",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "concern_type_rev",
              "displayName": "concern_type_rev",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "concern_type_del",
              "displayName": "concern_type_del",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "concern_type_cos",
              "displayName": "concern_type_cos",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "concern_type_data",
              "displayName": "concern_type_data",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "concern_type_bugs",
              "displayName": "concern_type_bugs",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "priority_set",
              "displayName": "priority_set",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "committed_date",
              "displayName": "committed_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "priority_immediate",
              "displayName": "priority_immediate",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "priority_add",
              "displayName": "priority_add",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "user_id",
              "displayName": "user_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "user",
              "displayName": "user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "department_head_id",
              "displayName": "department_head_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "department_head",
              "displayName": "department_head",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "it_head_id",
              "displayName": "it_head_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "it_head",
              "displayName": "it_head",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "integrator_id",
              "displayName": "integrator_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "integrator",
              "displayName": "integrator",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "developer_id",
              "displayName": "developer_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "developer",
              "displayName": "developer",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "qa_id",
              "displayName": "qa_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "qa",
              "displayName": "qa",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "print_option_as_req",
              "displayName": "print_option_as_req",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "print_out_date",
              "displayName": "print_out_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "print_option_sys_print",
              "displayName": "print_option_sys_print",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "system_print_date",
              "displayName": "system_print_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "print_option_modified",
              "displayName": "print_option_modified",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "patch_date",
              "displayName": "patch_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -176,
        -5232
      ],
      "id": "6ec9b3a9-c024-4eef-94c8-a1c858d2700f",
      "name": "Append row in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "name": "=",
        "driveId": {
          "__rl": true,
          "value": "My Drive",
          "mode": "list",
          "cachedResultName": "My Drive",
          "cachedResultUrl": "https://drive.google.com/drive/my-drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $json.id }}",
          "mode": "id"
        },
        "options": {
          "simplifyOutput": false
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -576,
        -4752
      ],
      "id": "9ff9a810-3a3f-4a00-a219-376855978e55",
      "name": "Upload file1",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Lm749rdsnAHcpKnx",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "\nconst binaries = $input.item.binary;\nconst output = [];\n\nfor (const [key, value] of Object.entries(binaries)) {\n  output.push({\n    binary: {\n      data: value\n    }\n  });\n}\n\nreturn output;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1168,
        -4736
      ],
      "id": "4d059c36-64c3-4d42-909c-91a140749fbf",
      "name": "Split Binary Files1"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -800,
        -4752
      ],
      "id": "5c521b15-58bf-49a3-b379-5e41ba47ac14",
      "name": "Merge2"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "create",
        "responseMode": "responseNode",
        "options": {
          "binaryPropertyName": "data"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1520,
        -4976
      ],
      "id": "729c3076-9cab-4ca9-9bd6-c282d440f6c4",
      "name": "Webhook2",
      "webhookId": "2a732598-6012-4ccd-a30c-957a859b279a"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.first().json.body;\n\nconst normalizeValue = (val) => {\n  if (Array.isArray(val)) {\n    return val[0] || '';\n  } else if (val && typeof val === 'object') {\n    return val.value || ''; // Adjust this if your object has a different structure\n  } else {\n    return val || '';\n  }\n};\n\nconst result = {\n  id: '=ROW()-1',\n  uuid: data.uuid || '',\n  type: data.type || '',\n  project: data.project || '',\n  date_requested: data.date_requested || '',\n  service_request_no: data.service_request_no || '',\n  department: data.department || '',\n  module: data.module || '',\n  system_form_no: data.system_form_no || '',\n  system_form_name: data.system_form_name || '',\n  concern_type_new: data.concern_type_new ?? 'No',\n  concern_type_rev: data.concern_type_rev ?? 'No',\n  concern_type_del: data.concern_type_del ?? 'No',\n  concern_type_cos: data.concern_type_cos ?? 'No',\n  priority_set: data.priority_set ?? 'No',\n  committed_date: data.committed_date || '',\n  priority_immediate: data.priority_immediate ?? 'No',\n  priority_add: data.priority_add ?? 'No',\n  user: data.user || '',\n  user_id: data.user_id || '',\n  department_head: data.department_head || '',\n  department_head_id: data.department_head_id || '',\n  it_head: data.it_head || '',\n  it_head_id: data.it_head_id || '',\n  integrator: data.integrator || '',\n  integrator_id: data.integrator_id || '',\n  developer: data.developer || '',\n  developer_id: data.developer_id || '',\n  qa: data.qa || '',\n  qa_id: data.qa_id || '',\n  print_option_as_req: data.print_option_as_req ?? 'No',\n  print_out_date: data.print_out_date || '',\n  print_option_sys_print: data.print_option_sys_print ?? 'No',\n  system_print_date: data.system_print_date || '',\n  print_option_modified: data.print_option_modified ?? 'No',\n  patch_date: data.patch_date || '',\n  memo: normalizeValue(data.memo),\n  req_status: normalizeValue(data.req_status),\n  cylix_status: normalizeValue(data.cylix_status),\n  dev_status: normalizeValue(data.dev_status),\n  concern_type_data: data.concern_type_data || '',\n  concern_type_bugs: data.concern_type_bugs || '',\n};\n\nreturn [{ json: { data: result } }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1168,
        -5088
      ],
      "id": "3936e321-2347-4b28-94a7-7dbfa892e65e",
      "name": "Extract Form Text"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        592,
        -4784
      ],
      "id": "730388af-e798-4ec8-a5a5-a6ef3e59fc9f",
      "name": "Respond to Webhook2"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1945959277,
          "mode": "list",
          "cachedResultName": "Files",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1945959277"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "GDriveID": "={{ $json.id }}",
            "Link": "={{ $json.webViewLink }}",
            "MainGUID": "={{ $json.foldername }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "MainGUID",
              "displayName": "MainGUID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "GDriveID",
              "displayName": "GDriveID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Link",
              "displayName": "Link",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        0,
        -4768
      ],
      "id": "49617ba4-541e-47f6-a55a-cd2bf145296a",
      "name": "Append row in sheet3",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "fieldToSplitOut": "id, webViewLink, foldername",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -192,
        -4768
      ],
      "id": "87d38800-5ab5-4194-959d-0281a8de7f47",
      "name": "Split Out2"
    },
    {
      "parameters": {
        "mode": "combineBySql",
        "query": "SELECT input2.id,input2.name,input2.webViewLink,input1.name foldername\nFROM input1\nJOIN input2 ",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -368,
        -4768
      ],
      "id": "5296500a-e058-43f9-ae2d-d21d7d02ad0a",
      "name": "Merge4"
    },
    {
      "parameters": {
        "jsCode": "// Sample input (replace with actual input if dynamic)\nconst input = $input.first().json.body;\nconst data_point = input.data_point || [];\nconst reference_field = input.reference_field || [];\nconst uuid = input.uuid || \"\";\n\n// Merge arrays into array of objects and filter out empty rows\nconst mergedData = data_point\n  .map((dp, index) => ({\n    mainuuid: uuid,\n    data_point: dp?.trim() || \"\",\n    reference_field: (reference_field[index] || \"\").trim()\n  }))\n  .filter(item => item.data_point !== \"\" || item.reference_field !== \"\"); // keep only non-empty rows\n\n// Return as items\nreturn mergedData.map(entry => ({ json: entry }));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1168,
        -4512
      ],
      "id": "21f2f886-d5aa-4ea0-bae8-de65c3e52f00",
      "name": "Data1"
    },
    {
      "parameters": {
        "fieldToSplitOut": "data_point, reference_field, mainuuid",
        "include": "allOtherFields",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -800,
        -4512
      ],
      "id": "178f249f-b92a-4b37-9705-048f705b56e9",
      "name": "Split Out3"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 519366898,
          "mode": "list",
          "cachedResultName": "Details",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=519366898"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "data_point": "={{ $json.data_point }}",
            "ref_field": "={{ $json.reference_field }}",
            "MainGUID": "={{ $json.mainuuid }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "MainGUID",
              "displayName": "MainGUID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "data_point",
              "displayName": "data_point",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ref_field",
              "displayName": "ref_field",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -560,
        -4512
      ],
      "id": "a860ddf1-4c1b-40ed-8996-423f3e299323",
      "name": "Append row in sheet4",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        368,
        -4784
      ],
      "id": "8d4ff06b-37e9-4d97-86e5-b90ccb83df09",
      "name": "Aggregate1"
    },
    {
      "parameters": {
        "content": "## CREATE\n**Double click** to edit me. [Guide](https://docs.n8n.io/workflows/sticky-notes/)",
        "height": 1264,
        "width": 2592
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1632,
        -5424
      ],
      "typeVersion": 1,
      "id": "ab8b1ae1-44f7-4b6a-a0e0-b71ab176b4f3",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "0eccf128-e14e-46c7-ba89-413a6376e075",
              "leftValue": "={{ $json.ID }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        112,
        -5744
      ],
      "id": "964831c1-9a16-49c0-84f4-588e8380e9fc",
      "name": "If"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.first().json.body;\n\nconst result = {\n  Id: data.Id || 0,\n  EmployeeName: data.EmployeeName || '',\n  UseName: data.UseName || '',\n  Password: data.Password || '',\n  Project: data.Project || ''\n  };\n\nreturn [{ json: { data: result } }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -592,
        -5664
      ],
      "id": "6843cf16-691f-4f2f-90f9-06377a5c7aaa",
      "name": "Temp"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "8d43cde4-027a-4ca7-a24c-6f74f12d6238",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.body.project }}",
                    "rightValue": "CNIMS"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "CNIMS"
            },
            {
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "399a0fbd-6be5-48e9-9f66-04cf385cb418",
                    "operator": {
                      "name": "filter.operator.equals",
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.body.project }}",
                    "rightValue": "CBMIS"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "CBMIS"
            },
            {
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "a69d387d-a174-42b3-bc5f-c8b46b7c2375",
                    "operator": {
                      "name": "filter.operator.equals",
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.body.project }}",
                    "rightValue": "CTMIS"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "CTMIS"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "5091517a-aaf1-401d-9220-a10e9d8ecaf9",
                    "leftValue": "={{ $json.body.project }}",
                    "rightValue": "CCMIS",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "CCMIS"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "e6edc879-0d09-415e-85cf-260bd4cdb68c",
                    "leftValue": "={{ $json.body.project }}",
                    "rightValue": "MDMIS",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "MDMIS"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d9d52551-6a82-4546-9cab-5154c41243d8",
                    "leftValue": "={{ $json.body.project }}",
                    "rightValue": "CYLIX",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "CYLIX"
            }
          ]
        },
        "options": {}
      },
      "id": "c229a5eb-a411-4395-b488-86d8162d037e",
      "name": "3. Switch Node",
      "type": "n8n-nodes-base.switch",
      "position": [
        -1296,
        -6288
      ],
      "typeVersion": 3.2
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1622259695,
          "mode": "list",
          "cachedResultName": "Users CNIMS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1622259695"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "UseName",
              "lookupValue": "={{ $json.body.username }}"
            },
            {
              "lookupColumn": "Password",
              "lookupValue": "={{ $json.body.password }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -608,
        -6800
      ],
      "id": "e08694c6-1e3a-4870-9009-2197e617c816",
      "name": "CNIMS",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1539716016,
          "mode": "list",
          "cachedResultName": "Users",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1539716016"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "UseName",
              "lookupValue": "={{ $json.body.username }}"
            },
            {
              "lookupColumn": "Password",
              "lookupValue": "={{ $json.body.password }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -608,
        -6608
      ],
      "id": "252504d2-32fb-4352-a561-592f821142f9",
      "name": "CBMIS",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1539716016,
          "mode": "list",
          "cachedResultName": "Users",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1539716016"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "UseName",
              "lookupValue": "={{ $json.body.username }}"
            },
            {
              "lookupColumn": "Password",
              "lookupValue": "={{ $json.body.password }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -608,
        -6400
      ],
      "id": "85eca543-5ad9-47fd-9ca2-7255b5440381",
      "name": "CTMIS",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1539716016,
          "mode": "list",
          "cachedResultName": "Users",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1539716016"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "UseName",
              "lookupValue": "={{ $json.body.username }}"
            },
            {
              "lookupColumn": "Password",
              "lookupValue": "={{ $json.body.password }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -608,
        -6224
      ],
      "id": "71e20732-9c26-400d-8d66-7320ff975889",
      "name": "CCMIS1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1539716016,
          "mode": "list",
          "cachedResultName": "Users",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1539716016"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "UseName",
              "lookupValue": "={{ $json.body.username }}"
            },
            {
              "lookupColumn": "Password",
              "lookupValue": "={{ $json.body.password }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -592,
        -6032
      ],
      "id": "da196f2c-9846-4739-b950-d01936405a2a",
      "name": "MDMIS",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1539716016,
          "mode": "list",
          "cachedResultName": "Users Cylix",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1539716016"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "UseName",
              "lookupValue": "={{ $json.body.username }}"
            },
            {
              "lookupColumn": "Password",
              "lookupValue": "={{ $json.body.password }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -592,
        -5872
      ],
      "id": "598acfd2-db53-4556-815b-f081c6293cfa",
      "name": "CYLIX",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "login",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1536,
        -6224
      ],
      "id": "5fda61c1-61f8-45d5-9c5a-170fa8245de2",
      "name": "Webhook3",
      "webhookId": "2e60f5e2-c417-40b5-a11e-009b55039841"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        384,
        -5856
      ],
      "id": "13d98b61-5a3f-4bb7-b2fb-7b66857a83ff",
      "name": "Respond to Webhook3"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -128,
        -5744
      ],
      "id": "aa4308ee-46a9-464b-a3f7-0b98340f034a",
      "name": "Merge5"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseKey": "error"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        384,
        -5632
      ],
      "id": "563cb59f-dc3c-4108-888c-005d9af2e8db",
      "name": "Respond to Webhook4"
    },
    {
      "parameters": {
        "content": "## LOGIN\n**Double click** to edit me. [Guide](https://docs.n8n.io/workflows/sticky-notes/)",
        "height": 1424,
        "width": 2592
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1632,
        -6880
      ],
      "typeVersion": 1,
      "id": "1232e67b-632f-42f3-b4e4-c58420f04a20",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "get-data-main",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "*"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1504,
        -1216
      ],
      "id": "b115dab8-38a8-4b04-9b16-ada63c99c62d",
      "name": "get",
      "webhookId": "9f23ff8b-950b-4f46-a18e-35b0fa3194bf"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "get-data-detail",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "*"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1504,
        -1056
      ],
      "id": "645a60c0-a22b-4847-9c54-ca092cba8bd9",
      "name": "get1",
      "webhookId": "9f23ff8b-950b-4f46-a18e-35b0fa3194bf"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "get-data-files",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "*"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1504,
        -880
      ],
      "id": "929b3fc6-f89b-457e-a1c9-673f4ee0af33",
      "name": "get2",
      "webhookId": "9f23ff8b-950b-4f46-a18e-35b0fa3194bf"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        -1056,
        -1216
      ],
      "id": "db3facaa-f65c-48e6-849e-7aaebb588883",
      "name": "Respond to Webhook12"
    },
    {
      "parameters": {
        "content": "## Get Data\n",
        "height": 700,
        "width": 988
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1632,
        -1280
      ],
      "typeVersion": 1,
      "id": "e04822c1-2768-4e05-93b9-f9581ab8e221",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1440184445,
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1440184445"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "uuid",
              "lookupValue": "={{ $json.body.uuid }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -1296,
        -1216
      ],
      "id": "1acbb1b8-2b94-4e93-848e-ebdcbbe92937",
      "name": "get All7",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 519366898,
          "mode": "list",
          "cachedResultName": "Details",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=519366898"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "MainGUID",
              "lookupValue": "={{ $json.body.uuid }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -1296,
        -1056
      ],
      "id": "108d2579-4660-4ff7-b093-85414f6d7fbc",
      "name": "get All8",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1945959277,
          "mode": "list",
          "cachedResultName": "Files",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1945959277"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "MainGUID",
              "lookupValue": "={{ $json.body.uuid }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -1296,
        -880
      ],
      "id": "5b4b4ff2-ee68-4c52-a48d-5e728dc189ff",
      "name": "get All9",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        -1056,
        -1056
      ],
      "id": "3c18d48a-3e08-4712-a981-a4fa5fa78229",
      "name": "Respond to Webhook13"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        -1056,
        -880
      ],
      "id": "a781f793-29fe-4a08-b7cb-7019d14fc296",
      "name": "Respond to Webhook14"
    },
    {
      "parameters": {
        "content": "## Get Functionalities\n",
        "height": 700,
        "width": 1596
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -624,
        -1280
      ],
      "typeVersion": 1,
      "id": "e93c7aa1-7551-43a9-8dfb-2c4998721d95",
      "name": "Sticky Note7"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "delete-file",
        "responseMode": "responseNode",
        "options": {
          "binaryPropertyName": "data"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -192,
        -2944
      ],
      "id": "547d6b8e-dbd8-4174-a471-c3605544168b",
      "name": "Webhook4",
      "webhookId": "659f7f10-403f-4279-8469-23426b2172c6"
    },
    {
      "parameters": {
        "content": "## REMOVE Files \n**Double click** to edit me. [Guide](https://docs.n8n.io/workflows/sticky-notes/)",
        "height": 304,
        "width": 1408
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -448,
        -3008
      ],
      "typeVersion": 1,
      "id": "e5c8ab6c-875b-4823-9e18-42e3a1f9842b",
      "name": "Sticky Note9"
    },
    {
      "parameters": {
        "operation": "deleteFile",
        "fileId": {
          "__rl": true,
          "value": "={{ $json.body.GDriveID }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        80,
        -2864
      ],
      "id": "4653d572-700a-4e5c-a07f-54047f75d6a1",
      "name": "Delete a file",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Lm749rdsnAHcpKnx",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "operation": "delete",
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1945959277,
          "mode": "list",
          "cachedResultName": "Files",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1945959277"
        },
        "startIndex": "={{ $json.row_number }}"
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        528,
        -2944
      ],
      "id": "925f2d7f-6260-4f43-8145-7b5302395a9f",
      "name": "Delete rows or columns from sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1945959277,
          "mode": "list",
          "cachedResultName": "Files",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1945959277"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "GDriveID",
              "lookupValue": "={{ $json.body.GDriveID }}"
            }
          ]
        },
        "options": {
          "returnFirstMatch": true
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        288,
        -2944
      ],
      "id": "5d9ae75d-1182-4f36-b055-25ab26dd4290",
      "name": "get detail1",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        768,
        -2864
      ],
      "id": "fc6e2214-e03c-48da-ba31-243451324ad2",
      "name": "Respond to Webhook17"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        -864,
        -416
      ],
      "id": "3c6eed5b-f244-4d6f-9934-8da8ac4e49cd",
      "name": "Respond to Webhook18"
    },
    {
      "parameters": {
        "content": "## Get Cylix Employees\n",
        "height": 352,
        "width": 988
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1632,
        -544
      ],
      "typeVersion": 1,
      "id": "9bfdaea3-c5be-4ffa-901f-c1f6bd0239a2",
      "name": "Sticky Note10"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1539716016,
          "mode": "list",
          "cachedResultName": "Users Cylix",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1539716016"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -1296,
        -416
      ],
      "id": "a4598107-69bd-4ee9-83a0-f37058266431",
      "name": "get All12",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "get-cylix",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "*"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1536,
        -416
      ],
      "id": "cffc3a87-c720-4061-a6b0-7fe810177240",
      "name": "get5",
      "webhookId": "555bdcef-fdc0-4a6a-9f37-14ed078b409e"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "0eccf128-e14e-46c7-ba89-413a6376e075",
              "leftValue": "={{ $json.ID }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        112,
        -7216
      ],
      "id": "f563ab21-8ddb-4d49-8675-0edcc196cee8",
      "name": "If1"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "8d43cde4-027a-4ca7-a24c-6f74f12d6238",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.body.project }}",
                    "rightValue": "CNIMS"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "CNIMS"
            },
            {
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "399a0fbd-6be5-48e9-9f66-04cf385cb418",
                    "operator": {
                      "name": "filter.operator.equals",
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.body.project }}",
                    "rightValue": "CBMIS"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "CBMIS"
            },
            {
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "a69d387d-a174-42b3-bc5f-c8b46b7c2375",
                    "operator": {
                      "name": "filter.operator.equals",
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.body.project }}",
                    "rightValue": "CTMIS"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "CTMIS"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "5091517a-aaf1-401d-9220-a10e9d8ecaf9",
                    "leftValue": "={{ $json.body.project }}",
                    "rightValue": "CCMIS",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "CCMIS"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "e6edc879-0d09-415e-85cf-260bd4cdb68c",
                    "leftValue": "={{ $json.body.project }}",
                    "rightValue": "MDMIS",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "MDMIS"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d9d52551-6a82-4546-9cab-5154c41243d8",
                    "leftValue": "={{ $json.body.project }}",
                    "rightValue": "CYLIX",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "CYLIX"
            }
          ]
        },
        "options": {}
      },
      "id": "03399f01-a578-40f6-b6c1-48775f0cafc0",
      "name": "3. Switch Node3",
      "type": "n8n-nodes-base.switch",
      "position": [
        -1296,
        -7760
      ],
      "typeVersion": 3.2
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1622259695,
          "mode": "list",
          "cachedResultName": "Users CNIMS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1622259695"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "ID",
              "lookupValue": "={{ $json.body.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -608,
        -8272
      ],
      "id": "6d112cec-9667-4ac8-a702-416ba4b75e6a",
      "name": "CNIMS1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1539716016,
          "mode": "list",
          "cachedResultName": "Users",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1539716016"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "UseName",
              "lookupValue": "={{ $json.body.username }}"
            },
            {
              "lookupColumn": "Password",
              "lookupValue": "={{ $json.body.password }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -608,
        -8080
      ],
      "id": "e5077c6a-8aba-408e-9d9a-4d197942a186",
      "name": "CBMIS1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1539716016,
          "mode": "list",
          "cachedResultName": "Users",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1539716016"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "UseName",
              "lookupValue": "={{ $json.body.username }}"
            },
            {
              "lookupColumn": "Password",
              "lookupValue": "={{ $json.body.password }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -608,
        -7872
      ],
      "id": "b9bd92ef-077b-4f50-b2d2-af0f4996ec41",
      "name": "CTMIS1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1539716016,
          "mode": "list",
          "cachedResultName": "Users",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1539716016"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "UseName",
              "lookupValue": "={{ $json.body.username }}"
            },
            {
              "lookupColumn": "Password",
              "lookupValue": "={{ $json.body.password }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -608,
        -7696
      ],
      "id": "f469aa22-42a3-416d-84b0-5bbc61ff37d1",
      "name": "CCMIS",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1539716016,
          "mode": "list",
          "cachedResultName": "Users",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1539716016"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "UseName",
              "lookupValue": "={{ $json.body.username }}"
            },
            {
              "lookupColumn": "Password",
              "lookupValue": "={{ $json.body.password }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -592,
        -7504
      ],
      "id": "3d7b7f52-88a8-466f-b3f5-7221226adfd8",
      "name": "MDMIS1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1539716016,
          "mode": "list",
          "cachedResultName": "Users Cylix",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1539716016"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "ID",
              "lookupValue": "={{ $json.body.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -592,
        -7344
      ],
      "id": "9504ff6a-0a15-4649-ad0c-acd54d331711",
      "name": "CYLIX1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "login-id",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1536,
        -7696
      ],
      "id": "ebfb67a1-e528-46e7-9eeb-2bd5f6ef3563",
      "name": "Webhook5",
      "webhookId": "2e60f5e2-c417-40b5-a11e-009b55039841"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        384,
        -7328
      ],
      "id": "6630da9c-ee1e-4ebd-bcc4-d6fd81cb7ac7",
      "name": "Respond to Webhook5"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -128,
        -7216
      ],
      "id": "08df63b8-581f-4fce-a830-f3136bfd4396",
      "name": "Merge6"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseKey": "error"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        384,
        -7104
      ],
      "id": "3aafb61c-5053-42f8-b496-30143eacd3bf",
      "name": "Respond to Webhook6"
    },
    {
      "parameters": {
        "content": "## LOGIN\n**Double click** to edit me. [Guide](https://docs.n8n.io/workflows/sticky-notes/)",
        "height": 1424,
        "width": 2592
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1632,
        -8352
      ],
      "typeVersion": 1,
      "id": "931d79ac-9bd9-428f-9ff6-8386432aa696",
      "name": "Sticky Note11"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.first().json.body;\n\nconst result = {\n  Id: data.Id || 0,\n  EmployeeName: data.EmployeeName || '',\n  UseName: data.UseName || '',\n  Password: data.Password || '',\n  Project: data.Project || ''\n  };\n\nreturn [{ json: { data: result } }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -592,
        -7136
      ],
      "id": "f0c5a290-7ec3-4b90-9a6b-0a60a259d2cf",
      "name": "Temp1"
    },
    {
      "parameters": {
        "jsCode": "// Get input data\nconst items = $input.all();\n\n// Sort by EmployeeName\nitems.sort((a, b) => {\n  const nameA = a.json.EmployeeName.toUpperCase();\n  const nameB = b.json.EmployeeName.toUpperCase();\n  return nameA.localeCompare(nameB);\n});\n\n// Return sorted items\nreturn items;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1088,
        -416
      ],
      "id": "c12838d6-34ea-4e8c-b30a-ca434146cd5a",
      "name": "Code4"
    },
    {
      "parameters": {
        "content": "## Get Department/Head/IT Head/User\n",
        "height": 1248,
        "width": 1596
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -624,
        -544
      ],
      "typeVersion": 1,
      "id": "760e6d84-78a8-44b6-9a75-63e97d4990d0",
      "name": "Sticky Note8"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        624,
        -432
      ],
      "id": "a87c4a77-8958-4acb-8263-5668643f61ef",
      "name": "Respond to Webhook31"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1622259695,
          "mode": "list",
          "cachedResultName": "Users CNIMS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1622259695"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        192,
        -432
      ],
      "id": "e9292149-f3ee-4e2a-9f92-cc6c2e57c3b7",
      "name": "get All18",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "get-department",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "*"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -496,
        -48
      ],
      "id": "fb2a3d9a-a4e8-4b68-872f-087c8781ceca",
      "name": "get6",
      "webhookId": "555bdcef-fdc0-4a6a-9f37-14ed078b409e"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.all();\nconst result = {};\nlet itHead = null;\n\n// --- Pass 1: Detect IT Head ---\ndata.forEach(item => {\n  const row = item.json;\n  const role = (row.Role || '').trim().toLowerCase();\n\n  if (role === 'it head') {\n    itHead = {\n      id: row.ID,\n      name: row.EmployeeName,\n      username: row.UseName,\n      position: row.Position\n    };\n  }\n});\n\n// --- Pass 2: Build Department Structure ---\ndata.forEach(item => {\n  const row = item.json;\n  const dept = row.Department || 'Unknown';\n  const role = (row.Role || '').trim().toLowerCase();\n\n  if (!result[dept]) {\n    result[dept] = { \"Head\": [], \"IT Head\": [], \"User\": [] };\n  }\n\n  const employee = {\n    id: row.ID,\n    name: row.EmployeeName,\n    username: row.UseName,\n    position: row.Position\n  };\n\n  //  Add to Head if role = Head\n  if (role === 'head' || role === 'it head') {\n    result[dept][\"Head\"].push(employee);\n  }\n\n  //  Add all employees (heads & users) under User list\n  if (role === 'head' || role === 'user' || role === 'it head') {\n    result[dept][\"User\"].push(employee);\n  }\n});\n\n// --- Pass 3: Attach IT Head to all departments ---\nif (itHead) {\n  Object.keys(result).forEach(dept => {\n    result[dept][\"IT Head\"] = [itHead];\n  });\n}\n\n// --- Optional: Sort all lists by name ---\nObject.keys(result).forEach(dept => {\n  [\"Head\", \"User\"].forEach(role => {\n    result[dept][role].sort((a, b) => a.name.localeCompare(b.name));\n  });\n});\n\nreturn [{ json: result }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        400,
        -432
      ],
      "id": "809e9fc6-9304-470e-8082-77a6f5764186",
      "name": "Code14"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "8d43cde4-027a-4ca7-a24c-6f74f12d6238",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.body.projectName }}",
                    "rightValue": "CNIMS"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "CNIMS"
            },
            {
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "399a0fbd-6be5-48e9-9f66-04cf385cb418",
                    "operator": {
                      "name": "filter.operator.equals",
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.body.projectName }}",
                    "rightValue": "CBMIS"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "CBMIS"
            },
            {
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "a69d387d-a174-42b3-bc5f-c8b46b7c2375",
                    "operator": {
                      "name": "filter.operator.equals",
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.body.projectName }}",
                    "rightValue": "CTMIS"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "CTMIS"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "5091517a-aaf1-401d-9220-a10e9d8ecaf9",
                    "leftValue": "={{ $json.body.projectName }}",
                    "rightValue": "CCMIS",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "CCMIS"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "e6edc879-0d09-415e-85cf-260bd4cdb68c",
                    "leftValue": "={{ $json.body.projectName }}",
                    "rightValue": "MDMIS",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "MDMIS"
            }
          ]
        },
        "options": {}
      },
      "id": "2d0b5f17-5b48-43b6-b259-ffcffd865864",
      "name": "3. Switch Node4",
      "type": "n8n-nodes-base.switch",
      "position": [
        -288,
        -96
      ],
      "typeVersion": 3.2
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        624,
        -240
      ],
      "id": "fde1aed1-4371-4257-be78-d3af3881d56d",
      "name": "Respond to Webhook7"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 805631201,
          "mode": "list",
          "cachedResultName": "Users CBMIS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=805631201"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        192,
        -240
      ],
      "id": "a8635684-989b-4a68-84cc-fad059fc58b6",
      "name": "get All19",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const data = $input.all();\nconst result = {};\nlet itHead = null;\n\n// --- Pass 1: Detect IT Head ---\ndata.forEach(item => {\n  const row = item.json;\n  const role = (row.Role || '').trim().toLowerCase();\n\n  if (role === 'it head') {\n    itHead = {\n      id: row.ID,\n      name: row.EmployeeName,\n      username: row.UseName,\n      position: row.Position\n    };\n  }\n});\n\n// --- Pass 2: Build Department Structure ---\ndata.forEach(item => {\n  const row = item.json;\n  const dept = row.Department || 'Unknown';\n  const role = (row.Role || '').trim().toLowerCase();\n\n  if (!result[dept]) {\n    result[dept] = { \"Head\": [], \"IT Head\": [], \"User\": [] };\n  }\n\n  const employee = {\n    id: row.ID,\n    name: row.EmployeeName,\n    username: row.UseName,\n    position: row.Position\n  };\n\n  //  Add to Head if role = Head\n  if (role === 'head' || role === 'it head') {\n    result[dept][\"Head\"].push(employee);\n  }\n\n  //  Add all employees (heads & users) under User list\n  if (role === 'head' || role === 'user' || role === 'it head') {\n    result[dept][\"User\"].push(employee);\n  }\n});\n\n// --- Pass 3: Attach IT Head to all departments ---\nif (itHead) {\n  Object.keys(result).forEach(dept => {\n    result[dept][\"IT Head\"] = [itHead];\n  });\n}\n\n// --- Optional: Sort all lists by name ---\nObject.keys(result).forEach(dept => {\n  [\"Head\", \"User\"].forEach(role => {\n    result[dept][role].sort((a, b) => a.name.localeCompare(b.name));\n  });\n});\n\nreturn [{ json: result }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        400,
        -240
      ],
      "id": "02c5ffe9-8144-41c8-84ec-b1e41b6d9064",
      "name": "Code15"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        640,
        144
      ],
      "id": "d4205627-1e02-4051-a7cc-b0d6bf833859",
      "name": "Respond to Webhook8"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 620791755,
          "mode": "list",
          "cachedResultName": "Users CCMIS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=620791755"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        208,
        144
      ],
      "id": "1ade95be-8538-41f3-aeae-6cbe6585601c",
      "name": "get All11",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const data = $input.all();\nconst result = {};\nlet itHead = null;\n\n// --- Pass 1: Detect IT Head ---\ndata.forEach(item => {\n  const row = item.json;\n  const role = (row.Role || '').trim().toLowerCase();\n\n  if (role === 'it head') {\n    itHead = {\n      id: row.ID,\n      name: row.EmployeeName,\n      username: row.UseName,\n      position: row.Position\n    };\n  }\n});\n\n// --- Pass 2: Build Department Structure ---\ndata.forEach(item => {\n  const row = item.json;\n  const dept = row.Department || 'Unknown';\n  const role = (row.Role || '').trim().toLowerCase();\n\n  if (!result[dept]) {\n    result[dept] = { \"Head\": [], \"IT Head\": [], \"User\": [] };\n  }\n\n  const employee = {\n    id: row.ID,\n    name: row.EmployeeName,\n    username: row.UseName,\n    position: row.Position\n  };\n\n  //  Add to Head if role = Head\n  if (role === 'head' || role === 'it head') {\n    result[dept][\"Head\"].push(employee);\n  }\n\n  //  Add all employees (heads & users) under User list\n  if (role === 'head' || role === 'user' || role === 'it head') {\n    result[dept][\"User\"].push(employee);\n  }\n});\n\n// --- Pass 3: Attach IT Head to all departments ---\nif (itHead) {\n  Object.keys(result).forEach(dept => {\n    result[dept][\"IT Head\"] = [itHead];\n  });\n}\n\n// --- Optional: Sort all lists by name ---\nObject.keys(result).forEach(dept => {\n  [\"Head\", \"User\"].forEach(role => {\n    result[dept][role].sort((a, b) => a.name.localeCompare(b.name));\n  });\n});\n\nreturn [{ json: result }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        416,
        144
      ],
      "id": "ba467dd6-66b0-4a7b-aabd-ac8b67fb7b6e",
      "name": "Code16"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "get-functionalities",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "*"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -288,
        -1008
      ],
      "id": "b961bd8f-cdf9-41dc-9865-63a993755970",
      "name": "get3",
      "webhookId": "899cf05f-32e5-4dfc-af7f-db7dcd5ce26a"
    },
    {
      "parameters": {
        "jsCode": "// Input: items from Google Sheet\nconst items = $input.all();\n\nconst result = {}; // Will store: Functionalities -> Project -> System -> Forms\n\nfor (const item of items) {\n  const row = item.json;\n\n  const project = row.Project?.trim();\n  const system = row.SystemName?.trim();\n  const formName = row.FormName?.trim();\n  const formNo = row.FormNo?.trim();\n\n  // Ensure project exists\n  if (!result[project]) {\n    result[project] = {};\n  }\n\n  // Ensure system under project exists\n  if (!result[project][system]) {\n    result[project][system] = [];\n  }\n\n  // Add form under system\n  result[project][system].push({\n    name: formName,\n    code: formNo\n  });\n}\n\n// Wrap in Functionalities\nreturn [\n  {\n    json: {\n      Functionalities: result\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        416,
        -1008
      ],
      "id": "44bda604-1a2a-4edb-88c6-fc6ef8a856ee",
      "name": "Code13"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        640,
        -1008
      ],
      "id": "dca58eb0-b3a2-47a9-b354-bcf3eede5392",
      "name": "Respond to Webhook30"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "15OwyB5a62wnfGMBxbJ26etmdRIbvQ5kWw1JlU0eqEuc",
          "mode": "list",
          "cachedResultName": "Service Request Defaults",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/15OwyB5a62wnfGMBxbJ26etmdRIbvQ5kWw1JlU0eqEuc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1561611199,
          "mode": "list",
          "cachedResultName": "Functionalities",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/15OwyB5a62wnfGMBxbJ26etmdRIbvQ5kWw1JlU0eqEuc/edit#gid=1561611199"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "Project",
              "lookupValue": "={{ $json.body.projectName }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        176,
        -1168
      ],
      "id": "89b099f2-5328-487a-a4bf-16b0bd8f5af8",
      "name": "get All17",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        640,
        336
      ],
      "id": "bddf6415-e984-44cf-ba63-0437862b314e",
      "name": "Respond to Webhook9"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 310414550,
          "mode": "list",
          "cachedResultName": "Users MDMIS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=310414550"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        208,
        336
      ],
      "id": "ce837c05-75ec-4dac-a709-b5d30c20ef9c",
      "name": "get All13",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const data = $input.all();\nconst result = {};\nlet itHead = null;\n\n// --- Pass 1: Detect IT Head ---\ndata.forEach(item => {\n  const row = item.json;\n  const role = (row.Role || '').trim().toLowerCase();\n\n  if (role === 'it head') {\n    itHead = {\n      id: row.ID,\n      name: row.EmployeeName,\n      username: row.UseName,\n      position: row.Position\n    };\n  }\n});\n\n// --- Pass 2: Build Department Structure ---\ndata.forEach(item => {\n  const row = item.json;\n  const dept = row.Department || 'Unknown';\n  const role = (row.Role || '').trim().toLowerCase();\n\n  if (!result[dept]) {\n    result[dept] = { \"Head\": [], \"IT Head\": [], \"User\": [] };\n  }\n\n  const employee = {\n    id: row.ID,\n    name: row.EmployeeName,\n    username: row.UseName,\n    position: row.Position\n  };\n\n  //  Add to Head if role = Head\n  if (role === 'head' || role === 'it head') {\n    result[dept][\"Head\"].push(employee);\n  }\n\n  //  Add all employees (heads & users) under User list\n  if (role === 'head' || role === 'user' || role === 'it head') {\n    result[dept][\"User\"].push(employee);\n  }\n});\n\n// --- Pass 3: Attach IT Head to all departments ---\nif (itHead) {\n  Object.keys(result).forEach(dept => {\n    result[dept][\"IT Head\"] = [itHead];\n  });\n}\n\n// --- Optional: Sort all lists by name ---\nObject.keys(result).forEach(dept => {\n  [\"Head\", \"User\"].forEach(role => {\n    result[dept][role].sort((a, b) => a.name.localeCompare(b.name));\n  });\n});\n\nreturn [{ json: result }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        416,
        336
      ],
      "id": "6bbb83ca-6448-4504-9117-36b67ba137db",
      "name": "Code17"
    },
    {
      "parameters": {
        "name": "=",
        "driveId": {
          "__rl": true,
          "value": "My Drive",
          "mode": "list",
          "cachedResultName": "My Drive",
          "cachedResultUrl": "https://drive.google.com/drive/my-drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $json.id }}",
          "mode": "id"
        },
        "options": {
          "simplifyOutput": false
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -32,
        -3216
      ],
      "id": "35f0f6eb-a1ad-4852-ae36-91484d3b1ea0",
      "name": "Upload file",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Lm749rdsnAHcpKnx",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "\nconst binaries = $input.item.binary;\nconst output = [];\n\nfor (const [key, value] of Object.entries(binaries)) {\n  output.push({\n    binary: {\n      data: value\n    }\n  });\n}\n\nreturn output;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -880,
        -3200
      ],
      "id": "cd475089-c2a5-4fc7-8b93-1d77923e2b8e",
      "name": "Split Binary Files"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -240,
        -3216
      ],
      "id": "96567ea3-3667-4466-bf64-d427fcb4852c",
      "name": "Merge"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.first().json.body;\n\nconst normalizeValue = (val) => {\n  if (Array.isArray(val)) {\n    return val[0] || '';\n  } else if (val && typeof val === 'object') {\n    return val.value || ''; // Adjust this if your object has a different structure\n  } else {\n    return val || '';\n  }\n};\n\nconst result = {\n  uuid: data.uuid || '',\n  type: data.type || '',\n  project: data.project || '',\n  date_requested: data.date_requested || '',\n  service_request_no: data.service_request_no || '',\n  department: data.department || '',\n  module: data.module || '',\n  system_form_no: data.system_form_no || '',\n  system_form_name: data.system_form_name || '',\n  concern_type_new: data.concern_type_new ?? 'No',\n  concern_type_rev: data.concern_type_rev ?? 'No',\n  concern_type_del: data.concern_type_del ?? 'No',\n  concern_type_cos: data.concern_type_cos ?? 'No',\n  priority_set: data.priority_set ?? 'No',\n  committed_date: data.committed_date || '',\n  priority_immediate: data.priority_immediate ?? 'No',\n  priority_add: data.priority_add ?? 'No',\n  user: data.user || '',\n  user_id: data.user_id || '',\n  department_head: data.department_head || '',\n  department_head_id: data.department_head_id || '',\n  it_head: data.it_head || '',\n  it_head_id: data.it_head_id || '',\n  integrator: data.integrator || '',\n  integrator_id: data.integrator_id || '',\n  developer: data.developer || '',\n  developer_id: data.developer_id || '',\n  qa: data.qa || '',\n  qa_id: data.qa_id || '',\n  print_option_as_req: data.print_option_as_req ?? 'No',\n  print_out_date: data.print_out_date || '',\n  print_option_sys_print: data.print_option_sys_print ?? 'No',\n  system_print_date: data.system_print_date || '',\n  print_option_modified: data.print_option_modified ?? 'No',\n  patch_date: data.patch_date || '',\n  memo: normalizeValue(data.memo),\n  req_status: normalizeValue(data.req_status),\n  cylix_status: normalizeValue(data.cylix_status),\n  dev_status: normalizeValue(data.dev_status),\n  concern_type_data: data.concern_type_data || '',\n  concern_type_bugs: data.concern_type_bugs || '',\n};\n\n \nreturn [{ json: result }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -896,
        -3984
      ],
      "id": "36cbd84b-06b8-4939-97bb-28da448216d9",
      "name": "Extract Form Text1"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1945959277,
          "mode": "list",
          "cachedResultName": "Files",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1945959277"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "GDriveID": "={{ $json.id }}",
            "Link": "={{ $json.webViewLink }}",
            "MainGUID": "={{ $json['body.uuid'] }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "MainGUID",
              "displayName": "MainGUID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "GDriveID",
              "displayName": "GDriveID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Link",
              "displayName": "Link",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        576,
        -3232
      ],
      "id": "f865730f-8f2e-4302-a0a3-b4914a793151",
      "name": "Append row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "fieldToSplitOut": "id, webViewLink, body.uuid",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        368,
        -3232
      ],
      "id": "29690543-c9ab-422d-b42c-c919a4570ab1",
      "name": "Split Out"
    },
    {
      "parameters": {
        "jsCode": "// Sample input (replace with actual input if dynamic)\nconst input = $input.first().json.body;\nconst data_point = input.data_point || [];\nconst reference_field = input.reference_field || [];\nconst uuid = input.uuid || \"\";\n\n// Merge arrays into array of objects and filter out empty rows\nconst mergedData = data_point\n  .map((dp, index) => ({\n    mainuuid: uuid,\n    data_point: dp?.trim() || \"\",\n    reference_field: (reference_field[index] || \"\").trim()\n  }))\n  .filter(item => item.data_point !== \"\" || item.reference_field !== \"\"); // keep only non-empty rows\n\n// Return as items\nreturn mergedData.map(entry => ({ json: entry }));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -896,
        -3712
      ],
      "id": "c96b4f3f-b8d6-41ab-af7b-51ced106da3e",
      "name": "Data"
    },
    {
      "parameters": {
        "fieldToSplitOut": "data_point, reference_field, mainuuid",
        "include": "allOtherFields",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -672,
        -3712
      ],
      "id": "85435df4-92cf-462d-a0b6-aa9e2b8e9855",
      "name": "Split Out1"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 519366898,
          "mode": "list",
          "cachedResultName": "Details",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=519366898"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "data_point": "={{ $json.data_point }}",
            "ref_field": "={{ $json.reference_field }}",
            "MainGUID": "={{ $json.mainuuid }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "MainGUID",
              "displayName": "MainGUID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "data_point",
              "displayName": "data_point",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ref_field",
              "displayName": "ref_field",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -448,
        -3712
      ],
      "id": "bacc50d6-54c8-4e5b-8e89-b561fdcb06f3",
      "name": "Append row in sheet2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        672,
        -3600
      ],
      "id": "319adf41-98c8-46ce-88c1-cf697b3609ce",
      "name": "Respond to Webhook"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        464,
        -3600
      ],
      "id": "753425d3-c8f6-45af-b2e0-7e63ed507f8e",
      "name": "Aggregate"
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "=",
        "returnAll": true,
        "filter": {},
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -896,
        -3520
      ],
      "id": "da4a5cf8-182e-47d8-bb74-ac0479a39437",
      "name": "Search files and folders",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Lm749rdsnAHcpKnx",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1440184445,
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1440184445"
        },
        "columns": {
          "mappingMode": "autoMapInputData",
          "value": {
            "id": "==row()-1",
            "project": "={{ $json.project }}",
            "date_requested": "={{ $json.date_requested }}",
            "service_request_no": "={{ $json.service_request_no }}",
            "department": "={{ $json.department }}",
            "module": "={{ $json.module }}",
            "system_form_name": "={{ $json.system_form_name }}",
            "concern_type_new": "={{ $json.concern_type_new }}",
            "concern_type_rev": "={{ $json.concern_type_rev }}",
            "concern_type_del": "={{ $json.concern_type_del }}",
            "concern_type_cos": "={{ $json.concern_type_cos }}",
            "priority_set": "={{ $json.priority_set }}",
            "committed_date": "={{ $json.committed_date }}",
            "priority_immediate": "={{ $json.priority_immediate }}",
            "priority_add": "={{ $json.priority_add }}",
            "user": "={{ $json.user }}",
            "department_head": "={{ $json.department_head }}",
            "it_head": "={{ $json.it_head }}",
            "integrator": "={{ $json.integrator }}",
            "developer": "={{ $json.developer }}",
            "qa": "={{ $json.qa }}",
            "print_option_as_req": "={{ $json.print_option_as_req }}",
            "print_out_date": "={{ $json.print_out_date }}",
            "print_option_sys_print": "={{ $json.print_option_sys_print }}",
            "system_print_date": "={{ $json.system_print_date }}",
            "print_option_modified": "={{ $json.print_option_modified }}",
            "patch_date": "={{ $json.patch_date }}"
          },
          "matchingColumns": [
            "uuid"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "type",
              "displayName": "type",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "uuid",
              "displayName": "uuid",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "project",
              "displayName": "project",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "date_requested",
              "displayName": "date_requested",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "service_request_no",
              "displayName": "service_request_no",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "req_status",
              "displayName": "req_status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "cylix_status",
              "displayName": "cylix_status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "dev_status",
              "displayName": "dev_status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "department",
              "displayName": "department",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "module",
              "displayName": "module",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "system_form_no",
              "displayName": "system_form_no",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "system_form_name",
              "displayName": "system_form_name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "memo",
              "displayName": "memo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "concern_type_new",
              "displayName": "concern_type_new",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "concern_type_rev",
              "displayName": "concern_type_rev",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "concern_type_del",
              "displayName": "concern_type_del",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "concern_type_cos",
              "displayName": "concern_type_cos",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "concern_type_data",
              "displayName": "concern_type_data",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "concern_type_bugs",
              "displayName": "concern_type_bugs",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "priority_set",
              "displayName": "priority_set",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "committed_date",
              "displayName": "committed_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "priority_immediate",
              "displayName": "priority_immediate",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "priority_add",
              "displayName": "priority_add",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "user_id",
              "displayName": "user_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "user",
              "displayName": "user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "department_head_id",
              "displayName": "department_head_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "department_head",
              "displayName": "department_head",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "it_head_id",
              "displayName": "it_head_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "it_head",
              "displayName": "it_head",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "integrator_id",
              "displayName": "integrator_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "integrator",
              "displayName": "integrator",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "developer_id",
              "displayName": "developer_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "developer",
              "displayName": "developer",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "qa_id",
              "displayName": "qa_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "qa",
              "displayName": "qa",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "print_option_as_req",
              "displayName": "print_option_as_req",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "print_out_date",
              "displayName": "print_out_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "print_option_sys_print",
              "displayName": "print_option_sys_print",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "system_print_date",
              "displayName": "system_print_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "print_option_modified",
              "displayName": "print_option_modified",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "patch_date",
              "displayName": "patch_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -672,
        -3984
      ],
      "id": "b9c7f5d6-3d4d-4791-b847-ecfc3ae30dab",
      "name": "Append or update row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        176,
        -3232
      ],
      "id": "8632c7a4-b18b-4b81-a397-0e84dfd18388",
      "name": "Merge1"
    },
    {
      "parameters": {
        "content": "## UPDATE|APPROVE|CANCEL\n**Double click** to edit me. [Guide](https://docs.n8n.io/workflows/sticky-notes/)",
        "height": 1088,
        "width": 2592
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1632,
        -4128
      ],
      "typeVersion": 1,
      "id": "1d75d52c-c3bb-4d8e-99c5-9838c69406c2",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "update",
        "responseMode": "responseNode",
        "options": {
          "binaryPropertyName": "data"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1440,
        -3680
      ],
      "id": "87ab9d4d-7e07-41a5-b733-d458519dac2b",
      "name": "Webhook1",
      "webhookId": "401da15d-1632-407f-957b-b5257e6aaa85"
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "={{ $json.name }}",
        "filter": {},
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -80,
        -3504
      ],
      "id": "d1951d07-3143-485d-a817-5ff9eaaf5d91",
      "name": "Search files and folders1",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Lm749rdsnAHcpKnx",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Set the name you're searching for\nconst searchName =$('Webhook1').first().json.body.uuid ;\n\n// Try to find the item by name\nconst match = items.find(item => item.json.name === searchName);\n\nif (match) {\n  return [match];\n} else {\n  // Return a temporary default object if no match\n  return [\n    {\n      json: {\n        id: \"temporary-id\",\n        name: searchName,\n        message: \"This is temporary data because no match was found\"\n      }\n    }\n  ];\n}\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -688,
        -3520
      ],
      "id": "1eb7e74d-3dee-4e32-983a-48fe1d562c27",
      "name": "Code1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "4fbcf8f6-ce66-474f-b74b-9a6a3d047278",
              "leftValue": "={{ $json.id }}",
              "rightValue": "temporary-id",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -496,
        -3520
      ],
      "id": "74401f52-671e-44a8-a996-b228cec637c5",
      "name": "If2"
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "={{ $json.name }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "1CfC_EqMaOBqNwvCe3TjOqzp25u61swcf",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1CfC_EqMaOBqNwvCe3TjOqzp25u61swcf"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -288,
        -3504
      ],
      "id": "48c69581-f2a0-43b8-91c9-c2ac8b9a3e88",
      "name": "Create folder1",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Lm749rdsnAHcpKnx",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "content": "## Get All Records\n",
        "height": 1356,
        "width": 2604
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1632,
        -2672
      ],
      "typeVersion": 1,
      "id": "0ed46919-ef41-4fa4-a5d3-00acef7582c1",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "8d43cde4-027a-4ca7-a24c-6f74f12d6238",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.user_role }}",
                    "rightValue": "User"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "User"
            },
            {
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "399a0fbd-6be5-48e9-9f66-04cf385cb418",
                    "operator": {
                      "name": "filter.operator.equals",
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.user_role }}",
                    "rightValue": "Head"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Head"
            },
            {
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "a69d387d-a174-42b3-bc5f-c8b46b7c2375",
                    "operator": {
                      "name": "filter.operator.equals",
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.user_role }}",
                    "rightValue": "IT Head"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "IT Head"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "5091517a-aaf1-401d-9220-a10e9d8ecaf9",
                    "leftValue": "={{ $json.user_role }}",
                    "rightValue": "Integrator",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Integrator"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "e6edc879-0d09-415e-85cf-260bd4cdb68c",
                    "leftValue": "={{ $json.user_role }}",
                    "rightValue": "Developer",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Developer"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "4d038646-bf2c-4166-9943-0531ee4acee3",
                    "leftValue": "={{ $json.user_role }}",
                    "rightValue": "Hybrid",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Hybrid"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra",
          "renameFallbackOutput": "Default"
        }
      },
      "id": "f5bc4df5-9721-411b-b215-1dcc02b7dc0b",
      "name": "3. Switch Node1",
      "type": "n8n-nodes-base.switch",
      "position": [
        -400,
        -2224
      ],
      "typeVersion": 3.2
    },
    {
      "parameters": {
        "jsCode": "const data = $input.all().map(item => item.json);\n\n// Dynamically get filters (from node params or previous data)\nconst requiredName = ( $('webhook_get').first()?.json?.body?.user?.name || \"\" ).trim();\n\n\nconst filtered = data.filter(obj => \n  Object.keys(obj).length > 0 && (obj.cylix_status !== 'Filed')  && (obj.qa === requiredName ||  obj.integrator === requiredName) || obj.qa === \"\" ||  obj.integrator === \"\");\n return filtered;\n\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -64,
        -2096
      ],
      "id": "7107defe-e6df-4fcc-af0b-231a6d8f9156",
      "name": "Code"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.all().map(item => item.json);\n\n// Dynamically get filters (from node params or previous data)\nconst requiredName = ( $('webhook_get').first()?.json?.body?.user?.name || \"\" ).trim();\n\n\nconst filtered = data.filter(obj => \n  Object.keys(obj).length > 0  &&   (( obj.developer === requiredName ||  obj.developer === \"\")) && (( obj.dev_status === \"For Development\" ||  obj.dev_status === \"Ongoing\"))\n  \n);\n return filtered;\n\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -64,
        -1936
      ],
      "id": "c7daf536-4177-4a86-b567-af40b93135a0",
      "name": "Code2"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.all().map(item => item.json);\n\n// Get the user's project from the switch node\nconst project = $input.first().json.user_project;\nlet filtered=[];\nif(project===\"CYLIX\"){\n filtered = data.filter(obj => Object.keys(obj).length > 0 && obj.cylix_status !== \"Filed\");\n}else{\n   filtered = data.filter(obj => Object.keys(obj).length > 0 && obj.cylix_status !== \"Filed\" && obj.project === project );\n}\n\n\nreturn filtered.map(item => ({ json: item }));"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -64,
        -1568
      ],
      "id": "cb4fcd1e-cb96-4b49-a020-d9d0a89baf83",
      "name": "Code3"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.all().map(item => item.json);\n\nconst requiredName = ( $('webhook_get').first()?.json?.body?.user?.name || \"\" ).trim();\n\n// First filter condition\nconst filtered1 = data.filter(obj =>\n  Object.keys(obj).length > 0 &&\n  obj.req_status === \"For IT Approval\" &&  (obj.it_head === \"\" || obj.it_head===requiredName) \n);\n\n// Second filter condition (example: priority is High)\nconst filtered2 = data.filter(obj =>\n  Object.keys(obj).length > 0 &&\n  obj.dev_status !== \"Deployed\"  && obj.cylix_status !== \"Completed\" &&  obj.user === requiredName  \n);\n\n// Second filter condition (example: priority is High)\nconst filtered3 = data.filter(obj =>\n  Object.keys(obj).length > 0 &&\n  obj.dev_status === \"Deployed\"  && obj.cylix_status !== \"Completed\" &&  obj.it_head === requiredName  \n);\n\n//  Union the results and remove duplicates by UUID\nconst union = [...new Map([...filtered1, ...filtered2, ...filtered3].map(item => [item.uuid, item])).values()];\n\nreturn union;\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -64,
        -2272
      ],
      "id": "265c0ef6-2675-4fb0-b26b-492f09e1d442",
      "name": "Code5"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.all().map(item => item.json);\n\n// Dynamically get filters (from node params or previous data)\nconst requiredName = ( $('webhook_get').first()?.json?.body?.user?.name || \"\" ).trim();\n\n\nconst filtered = data.filter(obj => \n  Object.keys(obj).length > 0 && (obj.cylix_status !== \"Filed\" || obj.cylix_status !== \"For Filing\") && ( obj.integrator === requiredName ||  obj.developer === requiredName  ||  obj.qa === requiredName || obj.integrator === \"\" ||  obj.developer === \"\" ||  obj.qa === \"\")\n  \n);\n return filtered;\n\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -64,
        -1744
      ],
      "id": "4c991678-693f-47df-83c0-b8e7c7b4eb03",
      "name": "Code6"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.all().map(item => item.json);\n\nconst filtered = data.filter(obj => \n  Object.keys(obj).length > 0 && obj.cylix_status !== \"Completed\")\n\n return filtered;\n\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -64,
        -2576
      ],
      "id": "ae0e53f1-3622-4c18-9140-99b066efb098",
      "name": "Code7"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.all().map(item => item.json);\n\n// Dynamically get filters (from node params or previous data)\nconst requiredName = ( $('webhook_get').first()?.json?.body?.user?.name || \"\" ).trim();\n\n\n\n// First filter condition\nconst filtered1 = data.filter(obj =>\n  Object.keys(obj).length > 0 &&\n  obj.cylix_status !== \"Completed\" &&  obj.head === \"\"\n);\n\n// Second filter condition (example: priority is High)\nconst filtered2 = data.filter(obj =>\n  Object.keys(obj).length > 0 //&& obj.cylix_status !== \"Completed\" &&  obj.head ===  requiredName\n);\n\n// // Second filter condition (example: priority is High)\n// const filtered3 = data.filter(obj =>\n//   Object.keys(obj).length > 0 &&\n//   obj.dev_status === \"Deployed\"  && obj.cylix_status !== \"Completed\" &&  obj.user === requiredName  \n// );\n\n\n//  Union the results and remove duplicates by UUID\nconst union = [...new Map([...filtered1, ...filtered2].map(item => [item.uuid, item])).values()];\n\nreturn union;\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -64,
        -2432
      ],
      "id": "1ad23f43-8db1-4cd7-a6aa-ddbcb0baf1c8",
      "name": "Code8"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        160,
        -2576
      ],
      "id": "ebe09c80-d481-46ae-8485-320673eef50c",
      "name": "Respond to Webhook19"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        160,
        -2432
      ],
      "id": "51478625-0e61-4841-a05f-a9caf9f9e5be",
      "name": "Respond to Webhook20"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        160,
        -2272
      ],
      "id": "68f486b5-48b8-4a31-821f-bc381c10c8f4",
      "name": "Respond to Webhook21"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        160,
        -2096
      ],
      "id": "f5284fe5-0690-4f87-a7cc-8692e81b6b32",
      "name": "Respond to Webhook22"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        160,
        -1936
      ],
      "id": "3be99128-2639-4a3d-8f53-fb2f7122ce48",
      "name": "Respond to Webhook23"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        160,
        -1744
      ],
      "id": "3ca180e5-a23d-4773-b4d2-8a406f7e216c",
      "name": "Respond to Webhook24"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        160,
        -1568
      ],
      "id": "b22a8e46-545d-459a-927c-c596ecc6a22b",
      "name": "Respond to Webhook25"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1440184445,
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1440184445"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "type",
              "lookupValue": "actual"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -1104,
        -2336
      ],
      "id": "ad36ddfc-3b2c-49ec-8b3d-34de24684ad1",
      "name": "get All",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 519366898,
          "mode": "list",
          "cachedResultName": "Details",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=519366898"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -1104,
        -2160
      ],
      "id": "0a069646-802a-48a9-827c-ecf8aa9328fb",
      "name": "get All1",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1945959277,
          "mode": "list",
          "cachedResultName": "Files",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1945959277"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -1104,
        -1968
      ],
      "id": "8534fefc-2779-4e25-85c4-911f6863d07d",
      "name": "get All2",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "get-all",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "*"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1408,
        -2160
      ],
      "id": "463e5440-4483-4501-b69f-940d9f7722ca",
      "name": "webhook_get",
      "webhookId": "52a5028b-eea3-4b96-a894-d5efb838dffd"
    },
    {
      "parameters": {
        "mode": "combineBySql",
        "numberInputs": 4,
        "query": "SELECT *\nFROM input1 \nLEFT JOIN input2 \n  ON input1.uuid = input2.MainGUID\nLEFT JOIN input3 \n  ON input1.uuid = input3.MainGUID\njoin input4\n",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -848,
        -2176
      ],
      "id": "cd55fc3f-3175-416c-914c-ffc9dc71d725",
      "name": "Merge7"
    },
    {
      "parameters": {
        "jsCode": "// Fields to keep\nconst mainFields = [\n  'id', 'type', 'uuid', 'project', 'date_requested', 'service_request_no', 'req_status',\n  'cylix_status', 'dev_status', 'department', 'module', 'system_form_no', 'system_form_name',\n  'memo', 'concern_type_new', 'concern_type_rev', 'concern_type_del', 'concern_type_cos',\n  'concern_type_data', 'concern_type_bugs', 'priority_set', 'committed_date',\n  'priority_immediate', 'priority_add', 'user_id', 'user', 'department_head_id',\n  'department_head', 'it_head_id', 'it_head', 'integrator_id', 'integrator', 'developer_id',\n  'developer', 'qa_id', 'qa', 'print_option_as_req', 'print_out_date', 'print_option_sys_print',\n  'system_print_date', 'print_option_modified', 'patch_date'\n];\nconst detailFields = ['MainGUID', 'data_point', 'ref_field'];\nconst fileFields = ['MainGUID', 'GDriveID', 'Link'];\n\n// Input branches\nconst mainItems = $input.all(0).map(i => i.json);\nconst detailItems = $input.all(1).map(i => i.json);\nconst fileItems = $input.all(2).map(i => i.json);\n\n// Field filter helper\nconst filterFields = (obj, fields) =>\n  Object.fromEntries(fields.map(f => [f, obj[f]]));\n\n// Deduplicate helper\nconst deduplicate = (arr) => {\n  const seen = new Set();\n  return arr.filter(item => {\n    const key = JSON.stringify(item);\n    if (seen.has(key)) return false;\n    seen.add(key);\n    return true;\n  });\n};\n\n// 1 Deduplicate mains by uuid\nconst uniqueMains = {};\nfor (const item of mainItems) {\n  const uuid = item.uuid;\n  if (!uniqueMains[uuid]) {\n    const mainObj = filterFields(item, mainFields);\n\n    // Add user role and project from body.user\n    mainObj.user_role = item?.body?.user?.role || null;\n    mainObj.user_project = item?.body?.user?.project || null;\n\n    uniqueMains[uuid] = mainObj;\n  }\n}\n\n// 2 Build final output  match details/files by uuid\nconst result = Object.values(uniqueMains).map(main => {\n  const uuid = main.uuid;\n  const matchedDetails = detailItems\n    .filter(d => d.MainGUID === uuid)\n    .map(d => filterFields(d, detailFields));\n  const matchedFiles = fileItems\n    .filter(f => f.MainGUID === uuid)\n    .map(f => filterFields(f, fileFields));\n\n  return {\n    json: {\n      ...main,\n      details: deduplicate(matchedDetails),\n      files: deduplicate(matchedFiles)\n    }\n  };\n});\n\nreturn result;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -624,
        -2144
      ],
      "id": "2e8abb13-c02f-41e5-8c93-ee779f433001",
      "name": "Code9"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.body.projectName }}",
                    "rightValue": "CYLIX",
                    "operator": {
                      "type": "string",
                      "operation": "notEquals"
                    },
                    "id": "4d13abda-be19-4c3c-bf8e-6a72a94b3959"
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra",
          "renameFallbackOutput": "Default"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -80,
        -1008
      ],
      "id": "fc7c3a84-f712-433c-af59-bf439d3e2e02",
      "name": "Switch"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "15OwyB5a62wnfGMBxbJ26etmdRIbvQ5kWw1JlU0eqEuc",
          "mode": "list",
          "cachedResultName": "Service Request Defaults",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/15OwyB5a62wnfGMBxbJ26etmdRIbvQ5kWw1JlU0eqEuc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1561611199,
          "mode": "list",
          "cachedResultName": "Functionalities",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/15OwyB5a62wnfGMBxbJ26etmdRIbvQ5kWw1JlU0eqEuc/edit#gid=1561611199"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        192,
        -832
      ],
      "id": "0abdcfbd-cb4f-43e0-ba87-47f50c3e346c",
      "name": "get All20",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "content": "## Get All Workloads Records\n",
        "height": 1356,
        "width": 2604
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1040,
        -2672
      ],
      "typeVersion": 1,
      "id": "64cb2649-eaa5-40d1-8f84-a82e4c87ecf7",
      "name": "Sticky Note12"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "8d43cde4-027a-4ca7-a24c-6f74f12d6238",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.user_role }}",
                    "rightValue": "User"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "User"
            },
            {
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "399a0fbd-6be5-48e9-9f66-04cf385cb418",
                    "operator": {
                      "name": "filter.operator.equals",
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.user_role }}",
                    "rightValue": "Head"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Head"
            },
            {
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "a69d387d-a174-42b3-bc5f-c8b46b7c2375",
                    "operator": {
                      "name": "filter.operator.equals",
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.user_role }}",
                    "rightValue": "IT Head"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "IT Head"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "5091517a-aaf1-401d-9220-a10e9d8ecaf9",
                    "leftValue": "={{ $json.user_role }}",
                    "rightValue": "Integrator",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Integrator"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "e6edc879-0d09-415e-85cf-260bd4cdb68c",
                    "leftValue": "={{ $json.user_role }}",
                    "rightValue": "Developer",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Developer"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "4d038646-bf2c-4166-9943-0531ee4acee3",
                    "leftValue": "={{ $json.user_role }}",
                    "rightValue": "Hybrid",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Hybrid"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra",
          "renameFallbackOutput": "Default"
        }
      },
      "id": "7cb4ed8a-8d84-4708-8f1c-70850ab5c163",
      "name": "3. Switch Node2",
      "type": "n8n-nodes-base.switch",
      "position": [
        2272,
        -2224
      ],
      "typeVersion": 3.2
    },
    {
      "parameters": {
        "jsCode": "\nconst data = $input.all().map(item => item.json);\n\n// Dynamically get filters (from node params or previous data)\nconst requiredName = ( $('webhook_get1').first()?.json?.body?.user?.name || \"\" ).trim();\n\n\nconst filtered = data.filter(obj => \n  Object.keys(obj).length > 0 &&  obj.qa === requiredName ||  obj.integrator === requiredName)\n\nreturn filtered;\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2608,
        -2096
      ],
      "id": "49c602b7-4f22-454a-bac1-bcb789d7bbeb",
      "name": "Code10"
    },
    {
      "parameters": {
        "jsCode": "\nconst data = $input.all().map(item => item.json);\n\n// Dynamically get filters (from node params or previous data)\nconst requiredName = ( $('webhook_get1').first()?.json?.body?.user?.name || \"\" ).trim();\n\n\nconst filtered = data.filter(obj => \n  Object.keys(obj).length > 0 &&  obj.developer === requiredName)\n\nreturn filtered;\n\n\n\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2608,
        -1936
      ],
      "id": "16fff031-6823-4d18-9113-68a4fa02b091",
      "name": "Code11"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.all().map(item => item.json);\n\n// Dynamically get filters (from node params or previous data)\nconst requiredName = ( $('webhook_get1').first()?.json?.body?.user?.name || \"\" ).trim();\n\n\nconst filtered = data.filter(obj => \n  Object.keys(obj).length > 0\n  \n);\n return filtered;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2608,
        -1568
      ],
      "id": "6dc32775-b41b-4dcb-8ccd-9a5e5f81e6c8",
      "name": "Code12"
    },
    {
      "parameters": {
        "jsCode": "\nconst data = $input.all().map(item => item.json);\n\n// Dynamically get filters (from node params or previous data)\nconst requiredName = ( $('webhook_get1').first()?.json?.body?.user?.name || \"\" ).trim();\n\n\nconst filtered = data.filter(obj => \n  Object.keys(obj).length > 0 &&  obj.it_head === requiredName)\n return filtered;\n\n\n\n\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2608,
        -2272
      ],
      "id": "f0bcec73-77eb-4157-9c5a-c335b39d5f90",
      "name": "Code18"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.all().map(item => item.json);\n\n// Dynamically get filters (from node params or previous data)\nconst requiredName = ( $('webhook_get1').first()?.json?.body?.user?.name || \"\" ).trim();\n\n\nconst filtered = data.filter(obj => \n  Object.keys(obj).length > 0 &&   (obj.integrator === requiredName ||  obj.developer === requiredName  ||  obj.qa === requiredName)\n  \n);\n return filtered;\n\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2608,
        -1744
      ],
      "id": "92f58775-f444-44a0-bc0b-2fc26c1d8de8",
      "name": "Code19"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.all().map(item => item.json);\n\n// Dynamically get filters (from node params or previous data)\nconst requiredName = ( $('webhook_get1').first()?.json?.body?.user?.name || \"\" ).trim();\n\n\nconst filtered = data.filter(obj => \n  Object.keys(obj).length > 0 &&  obj.user === requiredName)\n return filtered;\n\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2608,
        -2576
      ],
      "id": "fed54f80-b51c-4a02-b3cd-6f76fe1fafb9",
      "name": "Code20"
    },
    {
      "parameters": {
        "jsCode": "\nconst data = $input.all().map(item => item.json);\n\n// Dynamically get filters (from node params or previous data)\nconst requiredName = ( $('webhook_get1').first()?.json?.body?.user?.name || \"\" ).trim();\n\n\nconst filtered = data.filter(obj => \n  Object.keys(obj).length > 0 &&  obj.head === requiredName)\n return filtered;\n\n\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2608,
        -2432
      ],
      "id": "2f2e96a7-75fe-401a-ac4c-a45f1cdf53b4",
      "name": "Code21"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        2832,
        -2576
      ],
      "id": "f238784d-7ca0-4acf-90c8-08eab91506ad",
      "name": "Respond to Webhook26"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        2832,
        -2432
      ],
      "id": "d164d71c-a112-4197-98a7-7bbf9ecd7b85",
      "name": "Respond to Webhook27"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        2832,
        -2272
      ],
      "id": "a5ed769f-014b-4084-bef0-f50b3f24efc7",
      "name": "Respond to Webhook28"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        2832,
        -2096
      ],
      "id": "b0db23b6-9845-488a-a23f-258e7dfca5e6",
      "name": "Respond to Webhook29"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        2832,
        -1936
      ],
      "id": "f1bc8470-c7e9-4b14-874e-b9afb669094f",
      "name": "Respond to Webhook32"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        2832,
        -1744
      ],
      "id": "83256ac9-4bc1-4897-a0fa-84ae2fbb9773",
      "name": "Respond to Webhook33"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseKey": "data"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        2832,
        -1568
      ],
      "id": "a902e749-2e83-42d0-a557-9937d3c10c62",
      "name": "Respond to Webhook34"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1440184445,
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1440184445"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "type",
              "lookupValue": "actual"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        1568,
        -2336
      ],
      "id": "4457ad0b-426b-44a9-88d4-725c5ba53bac",
      "name": "get All3",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 519366898,
          "mode": "list",
          "cachedResultName": "Details",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=519366898"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        1568,
        -2160
      ],
      "id": "029da0e1-9ded-4afe-9a44-c3a914aa23aa",
      "name": "get All4",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40",
          "mode": "list",
          "cachedResultName": "Service Request",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1945959277,
          "mode": "list",
          "cachedResultName": "Files",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1v6ookIRqanQDN1VVpSU1ME11yXClhn6QOyuTVrUHt40/edit#gid=1945959277"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        1568,
        -1968
      ],
      "id": "4f6bcb42-684a-4f15-89f9-f597e037992e",
      "name": "get All5",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "De72zkM6aTeGmMSX",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "workload-all",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "*"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        1264,
        -2160
      ],
      "id": "79d1b175-936d-4168-b16a-7aecade6db0b",
      "name": "webhook_get1",
      "webhookId": "52a5028b-eea3-4b96-a894-d5efb838dffd"
    },
    {
      "parameters": {
        "mode": "combineBySql",
        "numberInputs": 4,
        "query": "SELECT *\nFROM input1 \nLEFT JOIN input2 \n  ON input1.uuid = input2.MainGUID\nLEFT JOIN input3 \n  ON input1.uuid = input3.MainGUID\njoin input4\n",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        1824,
        -2176
      ],
      "id": "cc29d582-0dc5-4401-ae8b-87cf6687e692",
      "name": "Merge8"
    },
    {
      "parameters": {
        "jsCode": "// Fields to keep\nconst mainFields = [\n  'id', 'type', 'uuid', 'project', 'date_requested', 'service_request_no', 'req_status',\n  'cylix_status', 'dev_status', 'department', 'module', 'system_form_no', 'system_form_name',\n  'memo', 'concern_type_new', 'concern_type_rev', 'concern_type_del', 'concern_type_cos',\n  'concern_type_data', 'concern_type_bugs', 'priority_set', 'committed_date',\n  'priority_immediate', 'priority_add', 'user_id', 'user', 'department_head_id',\n  'department_head', 'it_head_id', 'it_head', 'integrator_id', 'integrator', 'developer_id',\n  'developer', 'qa_id', 'qa', 'print_option_as_req', 'print_out_date', 'print_option_sys_print',\n  'system_print_date', 'print_option_modified', 'patch_date'\n];\nconst detailFields = ['MainGUID', 'data_point', 'ref_field'];\nconst fileFields = ['MainGUID', 'GDriveID', 'Link'];\n\n// Input branches\nconst mainItems = $input.all(0).map(i => i.json);\nconst detailItems = $input.all(1).map(i => i.json);\nconst fileItems = $input.all(2).map(i => i.json);\n\n// Field filter helper\nconst filterFields = (obj, fields) =>\n  Object.fromEntries(fields.map(f => [f, obj[f]]));\n\n// Deduplicate helper\nconst deduplicate = (arr) => {\n  const seen = new Set();\n  return arr.filter(item => {\n    const key = JSON.stringify(item);\n    if (seen.has(key)) return false;\n    seen.add(key);\n    return true;\n  });\n};\n\n// 1 Deduplicate mains by uuid\nconst uniqueMains = {};\nfor (const item of mainItems) {\n  const uuid = item.uuid;\n  if (!uniqueMains[uuid]) {\n    const mainObj = filterFields(item, mainFields);\n\n    // Add user role and project from body.user\n    mainObj.user_role = item?.body?.user?.role || null;\n    mainObj.user_project = item?.body?.user?.project || null;\n\n    uniqueMains[uuid] = mainObj;\n  }\n}\n\n// 2 Build final output  match details/files by uuid\nconst result = Object.values(uniqueMains).map(main => {\n  const uuid = main.uuid;\n  const matchedDetails = detailItems\n    .filter(d => d.MainGUID === uuid)\n    .map(d => filterFields(d, detailFields));\n  const matchedFiles = fileItems\n    .filter(f => f.MainGUID === uuid)\n    .map(f => filterFields(f, fileFields));\n\n  return {\n    json: {\n      ...main,\n      details: deduplicate(matchedDetails),\n      files: deduplicate(matchedFiles)\n    }\n  };\n});\n\nreturn result;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2048,
        -2144
      ],
      "id": "84b2cbd7-7696-4024-b940-2a17b6815cc6",
      "name": "Code22"
    }
  ],
  "pinData": {
    "Webhook": [
      {
        "json": {
          "headers": {
            "host": "500e18becc4f.ngrok-free.app",
            "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36",
            "content-length": "3597",
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "content-type": "multipart/form-data; boundary=----WebKitFormBoundaryo1UiuMXh7EAgdMsK",
            "origin": "http://127.0.0.1:5500",
            "priority": "u=1, i",
            "referer": "http://127.0.0.1:5500/",
            "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Google Chrome\";v=\"138\"",
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": "\"macOS\"",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "cross-site",
            "x-forwarded-for": "180.190.187.34",
            "x-forwarded-host": "500e18becc4f.ngrok-free.app",
            "x-forwarded-proto": "https"
          },
          "params": {},
          "query": {},
          "body": {
            "uuid": "ba6bccc0-ddca-4ea3-beb8-0be0538cb2cc",
            "req_status": "For IT Approval",
            "type": "actual",
            "project": "CNIMS",
            "date_requested": "2025-07-25",
            "service_request_no": "CNIMS-2025-07-0033",
            "department": "Office of the City Treasurer",
            "module": "ADMIN",
            "system_form_name": "Certificate of Occupancy",
            "system_form_no": "CMIS00026",
            "committed_date": "",
            "data_point": [
              "1",
              "2",
              "3"
            ],
            "reference_field": [
              "",
              "",
              ""
            ],
            "memo": "dsvdsv",
            "user": "",
            "user_id": "",
            "department_head": "Mark Jayson Ubas",
            "department_head_id": "1",
            "it_head": "",
            "it_head_id": "",
            "integrator": "",
            "integrator_id": "",
            "developer": "",
            "developer_id": "",
            "qa": "",
            "qa_id": "",
            "print_out_date": "",
            "system_print_date": "",
            "patch_date": ""
          },
          "webhookUrl": "http://localhost:5678/webhook/delete",
          "executionMode": "production"
        }
      }
    ],
    "Upload file1": [
      {
        "json": {
          "kind": "drive#file",
          "id": "1fNwswNY5zIduXXpIWek5O9ecjnioYAXQ",
          "name": "Screenshot 2025-07-17 at 1.10.14PM.png",
          "mimeType": "image/png",
          "starred": false,
          "trashed": false,
          "explicitlyTrashed": false,
          "parents": [
            "1_pveRhn6VJoRmQP3LdSAP2K2I2oOeNZ5"
          ],
          "spaces": [
            "drive"
          ],
          "version": "2",
          "webContentLink": "https://drive.google.com/uc?id=1fNwswNY5zIduXXpIWek5O9ecjnioYAXQ&export=download",
          "webViewLink": "https://drive.google.com/file/d/1fNwswNY5zIduXXpIWek5O9ecjnioYAXQ/view?usp=drivesdk",
          "iconLink": "https://drive-thirdparty.googleusercontent.com/16/type/image/png",
          "hasThumbnail": true,
          "thumbnailLink": "https://lh3.googleusercontent.com/drive-storage/AJQWtBOECezQTsAgKu-P0k2qTQcnIAgghGDY49Du8o_R5NDpHUmu7AyVkQxbALR_uuR6oDUCXqtEn3TkXGL4UYrrYzzcjqTBdYXaoGwMOsaIIHCLnw=s220",
          "thumbnailVersion": "2",
          "viewedByMe": false,
          "createdTime": "2025-07-22T15:28:06.100Z",
          "modifiedTime": "2025-07-22T15:28:07.216Z",
          "modifiedByMeTime": "2025-07-22T15:28:07.216Z",
          "modifiedByMe": true,
          "owners": [
            {
              "kind": "drive#user",
              "displayName": "Mark Jayson",
              "photoLink": "https://lh3.googleusercontent.com/a/ACg8ocKkkgX3N__yyPetherv6QGyLoJ6U6Dv2rVjMyrWP4xHSBBJzg=s64",
              "me": true,
              "permissionId": "09844518454357450176",
              "emailAddress": "sonjie.ai@gmail.com"
            }
          ],
          "lastModifyingUser": {
            "kind": "drive#user",
            "displayName": "Mark Jayson",
            "photoLink": "https://lh3.googleusercontent.com/a/ACg8ocKkkgX3N__yyPetherv6QGyLoJ6U6Dv2rVjMyrWP4xHSBBJzg=s64",
            "me": true,
            "permissionId": "09844518454357450176",
            "emailAddress": "sonjie.ai@gmail.com"
          },
          "shared": true,
          "ownedByMe": true,
          "downloadRestrictions": {
            "itemDownloadRestriction": {
              "restrictedForReaders": false,
              "restrictedForWriters": false
            },
            "effectiveDownloadRestrictionWithContext": {
              "restrictedForReaders": false,
              "restrictedForWriters": false
            }
          },
          "capabilities": {
            "canAcceptOwnership": false,
            "canAddChildren": false,
            "canAddMyDriveParent": false,
            "canChangeCopyRequiresWriterPermission": true,
            "canChangeItemDownloadRestriction": true,
            "canChangeSecurityUpdateEnabled": false,
            "canChangeViewersCanCopyContent": true,
            "canComment": true,
            "canCopy": true,
            "canDelete": true,
            "canDisableInheritedPermissions": false,
            "canDownload": true,
            "canEdit": true,
            "canEnableInheritedPermissions": true,
            "canListChildren": false,
            "canModifyContent": true,
            "canModifyContentRestriction": true,
            "canModifyEditorContentRestriction": true,
            "canModifyOwnerContentRestriction": true,
            "canModifyLabels": false,
            "canMoveChildrenWithinDrive": false,
            "canMoveItemIntoTeamDrive": true,
            "canMoveItemOutOfDrive": true,
            "canMoveItemWithinDrive": true,
            "canReadLabels": false,
            "canReadRevisions": true,
            "canRemoveChildren": false,
            "canRemoveContentRestriction": false,
            "canRemoveMyDriveParent": true,
            "canRename": true,
            "canShare": true,
            "canTrash": true,
            "canUntrash": true
          },
          "viewersCanCopyContent": true,
          "copyRequiresWriterPermission": false,
          "writersCanShare": true,
          "permissions": [
            {
              "kind": "drive#permission",
              "id": "anyoneWithLink",
              "type": "anyone",
              "role": "reader",
              "allowFileDiscovery": false
            },
            {
              "kind": "drive#permission",
              "id": "09844518454357450176",
              "type": "user",
              "emailAddress": "sonjie.ai@gmail.com",
              "role": "owner",
              "displayName": "sonjie.ai",
              "deleted": false,
              "pendingOwner": false
            },
            {
              "kind": "drive#permission",
              "id": "13267826029103856043",
              "type": "user",
              "emailAddress": "n8n-342@n8n-ai-464508.iam.gserviceaccount.com",
              "role": "writer",
              "displayName": "n8n-342",
              "deleted": false,
              "pendingOwner": false
            }
          ],
          "permissionIds": [
            "anyoneWithLink",
            "09844518454357450176",
            "13267826029103856043"
          ],
          "originalFilename": "Untitled",
          "fullFileExtension": "png",
          "fileExtension": "png",
          "md5Checksum": "2d1fe7a7879e372abd50d5fd3cbc8cbe",
          "sha1Checksum": "7eab3a4266cbaf86e5ef300e7bf865c2f87e0b50",
          "sha256Checksum": "3dba4b50a447a91167efcb4cabdd03e43ea69ebb20f3a6ac6fcf17a94509d75b",
          "size": "166147",
          "quotaBytesUsed": "166147",
          "headRevisionId": "0B3bmwU2wW0aHYWZQK1FoWlNXUkdLclZBTEc4R01rQTdmSExzPQ",
          "imageMediaMetadata": {
            "width": 2850,
            "height": 812,
            "rotation": 0
          },
          "isAppAuthorized": true,
          "linkShareMetadata": {
            "securityUpdateEligible": false,
            "securityUpdateEnabled": true
          },
          "inheritedPermissionsDisabled": false
        }
      },
      {
        "json": {
          "kind": "drive#file",
          "id": "1KkupP10bssyK-fNbe5w5XAFo-kHebDNa",
          "name": "Screenshot 2025-07-17 at 8.01.42AM.png",
          "mimeType": "image/png",
          "starred": false,
          "trashed": false,
          "explicitlyTrashed": false,
          "parents": [
            "1_pveRhn6VJoRmQP3LdSAP2K2I2oOeNZ5"
          ],
          "spaces": [
            "drive"
          ],
          "version": "2",
          "webContentLink": "https://drive.google.com/uc?id=1KkupP10bssyK-fNbe5w5XAFo-kHebDNa&export=download",
          "webViewLink": "https://drive.google.com/file/d/1KkupP10bssyK-fNbe5w5XAFo-kHebDNa/view?usp=drivesdk",
          "iconLink": "https://drive-thirdparty.googleusercontent.com/16/type/image/png",
          "hasThumbnail": true,
          "thumbnailLink": "https://lh3.googleusercontent.com/drive-storage/AJQWtBMedK_0mc7A0b2u6CvUUTyj6c26PoyoPkewsMgjKU-_HQXbaiMv1pOTpIQXRf6sw-kINfrt93WWtuadwFhEGUWX3j1gPb4yRhyfzzCqKjm4ACA=s220",
          "thumbnailVersion": "2",
          "viewedByMe": false,
          "createdTime": "2025-07-22T15:28:10.132Z",
          "modifiedTime": "2025-07-22T15:28:11.564Z",
          "modifiedByMeTime": "2025-07-22T15:28:11.564Z",
          "modifiedByMe": true,
          "owners": [
            {
              "kind": "drive#user",
              "displayName": "Mark Jayson",
              "photoLink": "https://lh3.googleusercontent.com/a/ACg8ocKkkgX3N__yyPetherv6QGyLoJ6U6Dv2rVjMyrWP4xHSBBJzg=s64",
              "me": true,
              "permissionId": "09844518454357450176",
              "emailAddress": "sonjie.ai@gmail.com"
            }
          ],
          "lastModifyingUser": {
            "kind": "drive#user",
            "displayName": "Mark Jayson",
            "photoLink": "https://lh3.googleusercontent.com/a/ACg8ocKkkgX3N__yyPetherv6QGyLoJ6U6Dv2rVjMyrWP4xHSBBJzg=s64",
            "me": true,
            "permissionId": "09844518454357450176",
            "emailAddress": "sonjie.ai@gmail.com"
          },
          "shared": true,
          "ownedByMe": true,
          "downloadRestrictions": {
            "itemDownloadRestriction": {
              "restrictedForReaders": false,
              "restrictedForWriters": false
            },
            "effectiveDownloadRestrictionWithContext": {
              "restrictedForReaders": false,
              "restrictedForWriters": false
            }
          },
          "capabilities": {
            "canAcceptOwnership": false,
            "canAddChildren": false,
            "canAddMyDriveParent": false,
            "canChangeCopyRequiresWriterPermission": true,
            "canChangeItemDownloadRestriction": true,
            "canChangeSecurityUpdateEnabled": false,
            "canChangeViewersCanCopyContent": true,
            "canComment": true,
            "canCopy": true,
            "canDelete": true,
            "canDisableInheritedPermissions": false,
            "canDownload": true,
            "canEdit": true,
            "canEnableInheritedPermissions": true,
            "canListChildren": false,
            "canModifyContent": true,
            "canModifyContentRestriction": true,
            "canModifyEditorContentRestriction": true,
            "canModifyOwnerContentRestriction": true,
            "canModifyLabels": false,
            "canMoveChildrenWithinDrive": false,
            "canMoveItemIntoTeamDrive": true,
            "canMoveItemOutOfDrive": true,
            "canMoveItemWithinDrive": true,
            "canReadLabels": false,
            "canReadRevisions": true,
            "canRemoveChildren": false,
            "canRemoveContentRestriction": false,
            "canRemoveMyDriveParent": true,
            "canRename": true,
            "canShare": true,
            "canTrash": true,
            "canUntrash": true
          },
          "viewersCanCopyContent": true,
          "copyRequiresWriterPermission": false,
          "writersCanShare": true,
          "permissions": [
            {
              "kind": "drive#permission",
              "id": "anyoneWithLink",
              "type": "anyone",
              "role": "reader",
              "allowFileDiscovery": false
            },
            {
              "kind": "drive#permission",
              "id": "09844518454357450176",
              "type": "user",
              "emailAddress": "sonjie.ai@gmail.com",
              "role": "owner",
              "displayName": "sonjie.ai",
              "deleted": false,
              "pendingOwner": false
            },
            {
              "kind": "drive#permission",
              "id": "13267826029103856043",
              "type": "user",
              "emailAddress": "n8n-342@n8n-ai-464508.iam.gserviceaccount.com",
              "role": "writer",
              "displayName": "n8n-342",
              "deleted": false,
              "pendingOwner": false
            }
          ],
          "permissionIds": [
            "anyoneWithLink",
            "09844518454357450176",
            "13267826029103856043"
          ],
          "originalFilename": "Untitled",
          "fullFileExtension": "png",
          "fileExtension": "png",
          "md5Checksum": "b895d3986076f469af1de993be7424cd",
          "sha1Checksum": "c880daddcf162640d0d864df4b66524b18465a5f",
          "sha256Checksum": "065bee1f7b756a7bf2dcc2c1c8fd7356ce5944b6d86bd29d39ff3e88b6a55dd8",
          "size": "529908",
          "quotaBytesUsed": "529908",
          "headRevisionId": "0B3bmwU2wW0aHcFVNL1RRSE5KaUVLZnhLS3c3MjJQSGdnZSswPQ",
          "imageMediaMetadata": {
            "width": 2704,
            "height": 1516,
            "rotation": 0
          },
          "isAppAuthorized": true,
          "linkShareMetadata": {
            "securityUpdateEligible": false,
            "securityUpdateEnabled": true
          },
          "inheritedPermissionsDisabled": false
        }
      },
      {
        "json": {
          "kind": "drive#file",
          "id": "1O1qf9deQq5iAKNjNA1xZrK7j5dZCVu87",
          "name": "Screenshot 2025-07-19 at 11.32.11AM.png",
          "mimeType": "image/png",
          "starred": false,
          "trashed": false,
          "explicitlyTrashed": false,
          "parents": [
            "1_pveRhn6VJoRmQP3LdSAP2K2I2oOeNZ5"
          ],
          "spaces": [
            "drive"
          ],
          "version": "2",
          "webContentLink": "https://drive.google.com/uc?id=1O1qf9deQq5iAKNjNA1xZrK7j5dZCVu87&export=download",
          "webViewLink": "https://drive.google.com/file/d/1O1qf9deQq5iAKNjNA1xZrK7j5dZCVu87/view?usp=drivesdk",
          "iconLink": "https://drive-thirdparty.googleusercontent.com/16/type/image/png",
          "hasThumbnail": true,
          "thumbnailLink": "https://lh3.googleusercontent.com/drive-storage/AJQWtBPcNRue39hpxeF36AiqaH_JbF-zU_oJnA0tDAN_lEewqnZI8CGTh3VWKfUafvGyfkBNK9KN0glcFG1Vpafi0RqsL7lOBkyJRcGTtMi0wCbZew=s220",
          "thumbnailVersion": "2",
          "viewedByMe": false,
          "createdTime": "2025-07-22T15:28:12.735Z",
          "modifiedTime": "2025-07-22T15:28:13.834Z",
          "modifiedByMeTime": "2025-07-22T15:28:13.834Z",
          "modifiedByMe": true,
          "owners": [
            {
              "kind": "drive#user",
              "displayName": "Mark Jayson",
              "photoLink": "https://lh3.googleusercontent.com/a/ACg8ocKkkgX3N__yyPetherv6QGyLoJ6U6Dv2rVjMyrWP4xHSBBJzg=s64",
              "me": true,
              "permissionId": "09844518454357450176",
              "emailAddress": "sonjie.ai@gmail.com"
            }
          ],
          "lastModifyingUser": {
            "kind": "drive#user",
            "displayName": "Mark Jayson",
            "photoLink": "https://lh3.googleusercontent.com/a/ACg8ocKkkgX3N__yyPetherv6QGyLoJ6U6Dv2rVjMyrWP4xHSBBJzg=s64",
            "me": true,
            "permissionId": "09844518454357450176",
            "emailAddress": "sonjie.ai@gmail.com"
          },
          "shared": true,
          "ownedByMe": true,
          "downloadRestrictions": {
            "itemDownloadRestriction": {
              "restrictedForReaders": false,
              "restrictedForWriters": false
            },
            "effectiveDownloadRestrictionWithContext": {
              "restrictedForReaders": false,
              "restrictedForWriters": false
            }
          },
          "capabilities": {
            "canAcceptOwnership": false,
            "canAddChildren": false,
            "canAddMyDriveParent": false,
            "canChangeCopyRequiresWriterPermission": true,
            "canChangeItemDownloadRestriction": true,
            "canChangeSecurityUpdateEnabled": false,
            "canChangeViewersCanCopyContent": true,
            "canComment": true,
            "canCopy": true,
            "canDelete": true,
            "canDisableInheritedPermissions": false,
            "canDownload": true,
            "canEdit": true,
            "canEnableInheritedPermissions": true,
            "canListChildren": false,
            "canModifyContent": true,
            "canModifyContentRestriction": true,
            "canModifyEditorContentRestriction": true,
            "canModifyOwnerContentRestriction": true,
            "canModifyLabels": false,
            "canMoveChildrenWithinDrive": false,
            "canMoveItemIntoTeamDrive": true,
            "canMoveItemOutOfDrive": true,
            "canMoveItemWithinDrive": true,
            "canReadLabels": false,
            "canReadRevisions": true,
            "canRemoveChildren": false,
            "canRemoveContentRestriction": false,
            "canRemoveMyDriveParent": true,
            "canRename": true,
            "canShare": true,
            "canTrash": true,
            "canUntrash": true
          },
          "viewersCanCopyContent": true,
          "copyRequiresWriterPermission": false,
          "writersCanShare": true,
          "permissions": [
            {
              "kind": "drive#permission",
              "id": "anyoneWithLink",
              "type": "anyone",
              "role": "reader",
              "allowFileDiscovery": false
            },
            {
              "kind": "drive#permission",
              "id": "09844518454357450176",
              "type": "user",
              "emailAddress": "sonjie.ai@gmail.com",
              "role": "owner",
              "displayName": "sonjie.ai",
              "deleted": false,
              "pendingOwner": false
            },
            {
              "kind": "drive#permission",
              "id": "13267826029103856043",
              "type": "user",
              "emailAddress": "n8n-342@n8n-ai-464508.iam.gserviceaccount.com",
              "role": "writer",
              "displayName": "n8n-342",
              "deleted": false,
              "pendingOwner": false
            }
          ],
          "permissionIds": [
            "anyoneWithLink",
            "09844518454357450176",
            "13267826029103856043"
          ],
          "originalFilename": "Untitled",
          "fullFileExtension": "png",
          "fileExtension": "png",
          "md5Checksum": "08c0a2da89e0e7ecd5045f9b784a7c84",
          "sha1Checksum": "9f69db13d7e9f29ae35cbe0822fa9bc8044db278",
          "sha256Checksum": "521a09404ef6edda2e6c95a025f90a4cf1cd2bbcafcb054ecf2547c96cebc8c7",
          "size": "43357",
          "quotaBytesUsed": "43357",
          "headRevisionId": "0B3bmwU2wW0aHNVkrUE5MZEoySmVNU25UbEVabERzL204dmFJPQ",
          "imageMediaMetadata": {
            "width": 1832,
            "height": 576,
            "rotation": 0
          },
          "isAppAuthorized": true,
          "linkShareMetadata": {
            "securityUpdateEligible": false,
            "securityUpdateEnabled": true
          },
          "inheritedPermissionsDisabled": false
        }
      }
    ],
    "Split Out2": [
      {
        "json": {
          "id": "1jdI8ycFZ0_g0coU5iofqAGgr6ZaY7Nrz",
          "webViewLink": "https://drive.google.com/file/d/1jdI8ycFZ0_g0coU5iofqAGgr6ZaY7Nrz/view?usp=drivesdk",
          "foldername": "7dcd0b1d-d93a-4b81-afe5-903b780e19be"
        }
      },
      {
        "json": {
          "id": "1l-pKMmaJMAN_4zuCqQZ_pbrar2zhMkCa",
          "webViewLink": "https://drive.google.com/file/d/1l-pKMmaJMAN_4zuCqQZ_pbrar2zhMkCa/view?usp=drivesdk",
          "foldername": "7dcd0b1d-d93a-4b81-afe5-903b780e19be"
        }
      },
      {
        "json": {
          "id": "1HyVKse5vH_dO5zp19U1KBXGK5YXPYoOH",
          "webViewLink": "https://drive.google.com/file/d/1HyVKse5vH_dO5zp19U1KBXGK5YXPYoOH/view?usp=drivesdk",
          "foldername": "7dcd0b1d-d93a-4b81-afe5-903b780e19be"
        }
      }
    ],
    "Merge4": [
      {
        "json": {
          "id": "1vZeb5jiHxskmx5ry0V-5WDYuOTMUkEhw",
          "name": "Screenshot 2025-07-19 at 11.32.11AM.png",
          "webViewLink": "https://drive.google.com/file/d/1vZeb5jiHxskmx5ry0V-5WDYuOTMUkEhw/view?usp=drivesdk",
          "foldername": "6ba66db8-47a8-48ce-95d6-c41a95846b96"
        }
      },
      {
        "json": {
          "id": "1AXL4cWSNd_foHwf9elo6HNwG2V_xRe9p",
          "name": "Screenshot 2025-07-17 at 1.10.14PM.png",
          "webViewLink": "https://drive.google.com/file/d/1AXL4cWSNd_foHwf9elo6HNwG2V_xRe9p/view?usp=drivesdk",
          "foldername": "6ba66db8-47a8-48ce-95d6-c41a95846b96"
        }
      },
      {
        "json": {
          "id": "114909CCQwSqD5KI0pcWWwiENgHTvcABy",
          "name": "Screenshot 2025-07-17 at 8.01.42AM.png",
          "webViewLink": "https://drive.google.com/file/d/114909CCQwSqD5KI0pcWWwiENgHTvcABy/view?usp=drivesdk",
          "foldername": "6ba66db8-47a8-48ce-95d6-c41a95846b96"
        }
      }
    ],
    "Merge5": [
      {
        "json": {
          "row_number": 2,
          "ID": 1,
          "EmployeeName": "Mark Jayson Ubas",
          "UseName": "sa",
          "Password": "sa",
          "Project": "CBMIS"
        }
      },
      {
        "json": {
          "data": {
            "Id": 0,
            "EmployeeName": "",
            "UseName": "",
            "Password": "",
            "Project": ""
          }
        }
      }
    ],
    "get": [
      {
        "json": {
          "headers": {
            "host": "500e18becc4f.ngrok-free.app",
            "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36",
            "content-length": "47",
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "content-type": "application/json",
            "origin": "http://127.0.0.1:5500",
            "priority": "u=1, i",
            "referer": "http://127.0.0.1:5500/",
            "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Google Chrome\";v=\"138\"",
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": "\"macOS\"",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "cross-site",
            "x-forwarded-for": "180.190.188.71",
            "x-forwarded-host": "500e18becc4f.ngrok-free.app",
            "x-forwarded-proto": "https"
          },
          "params": {},
          "query": {},
          "body": {
            "uuid": "3ab0d2be-3916-42c1-9ece-eaa7b6290ae5"
          },
          "webhookUrl": "http://localhost:5678/webhook/get-data",
          "executionMode": "production"
        }
      }
    ],
    "get1": [
      {
        "json": {
          "headers": {
            "host": "500e18becc4f.ngrok-free.app",
            "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36",
            "content-length": "47",
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "content-type": "application/json",
            "origin": "http://127.0.0.1:5500",
            "priority": "u=1, i",
            "referer": "http://127.0.0.1:5500/",
            "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Google Chrome\";v=\"138\"",
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": "\"macOS\"",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "cross-site",
            "x-forwarded-for": "180.190.188.71",
            "x-forwarded-host": "500e18becc4f.ngrok-free.app",
            "x-forwarded-proto": "https"
          },
          "params": {},
          "query": {},
          "body": {
            "uuid": "3ab0d2be-3916-42c1-9ece-eaa7b6290ae5"
          },
          "webhookUrl": "http://localhost:5678/webhook/get-data",
          "executionMode": "production"
        }
      }
    ],
    "get2": [
      {
        "json": {
          "headers": {
            "host": "500e18becc4f.ngrok-free.app",
            "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36",
            "content-length": "47",
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "content-type": "application/json",
            "origin": "http://127.0.0.1:5500",
            "priority": "u=1, i",
            "referer": "http://127.0.0.1:5500/",
            "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Google Chrome\";v=\"138\"",
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": "\"macOS\"",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "cross-site",
            "x-forwarded-for": "180.190.188.71",
            "x-forwarded-host": "500e18becc4f.ngrok-free.app",
            "x-forwarded-proto": "https"
          },
          "params": {},
          "query": {},
          "body": {
            "uuid": "3934b055-aed1-4105-b207-df1a62e46b73"
          },
          "webhookUrl": "http://localhost:5678/webhook/get-data",
          "executionMode": "production"
        }
      }
    ],
    "Webhook4": [
      {
        "json": {
          "headers": {
            "host": "500e18becc4f.ngrok-free.app",
            "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36",
            "content-length": "48",
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "content-type": "application/json",
            "origin": "http://127.0.0.1:5500",
            "priority": "u=1, i",
            "referer": "http://127.0.0.1:5500/",
            "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Google Chrome\";v=\"138\"",
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": "\"macOS\"",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "cross-site",
            "x-forwarded-for": "180.190.187.34",
            "x-forwarded-host": "500e18becc4f.ngrok-free.app",
            "x-forwarded-proto": "https"
          },
          "params": {},
          "query": {},
          "body": {
            "GDriveID": "1LQ6BK9SCMBLYilZcbWZv_nNL4FtLYap2"
          },
          "webhookUrl": "http://localhost:5678/webhook/delete-file",
          "executionMode": "production"
        }
      }
    ],
    "get5": [
      {
        "json": {
          "headers": {
            "host": "f33f9373d24d.ngrok-free.app",
            "user-agent": "Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36 Edg/138.0.0.0",
            "content-length": "23",
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "content-type": "application/json",
            "origin": "http://127.0.0.1:5500",
            "priority": "u=1, i",
            "referer": "http://127.0.0.1:5500/",
            "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Microsoft Edge\";v=\"138\"",
            "sec-ch-ua-mobile": "?1",
            "sec-ch-ua-platform": "\"Android\"",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "cross-site",
            "x-forwarded-for": "180.190.187.34",
            "x-forwarded-host": "f33f9373d24d.ngrok-free.app",
            "x-forwarded-proto": "https"
          },
          "params": {},
          "query": {},
          "body": {
            "projectName": "CBMIS"
          },
          "webhookUrl": "http://localhost:5678/webhook/get-all",
          "executionMode": "production"
        }
      }
    ],
    "Webhook3": [
      {
        "json": {
          "headers": {
            "host": "500e18becc4f.ngrok-free.app",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0",
            "content-length": "51",
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "content-type": "application/json",
            "origin": "http://127.0.0.1:5500",
            "priority": "u=1, i",
            "referer": "http://127.0.0.1:5500/",
            "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Microsoft Edge\";v=\"138\"",
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": "\"Windows\"",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "cross-site",
            "x-forwarded-for": "119.92.236.5",
            "x-forwarded-host": "500e18becc4f.ngrok-free.app",
            "x-forwarded-proto": "https"
          },
          "params": {},
          "query": {},
          "body": {
            "username": "sa",
            "password": "sa",
            "project": "CYLIX"
          },
          "webhookUrl": "http://localhost:5678/webhook/login",
          "executionMode": "production"
        }
      }
    ],
    "Webhook2": [
      {
        "json": {
          "headers": {
            "host": "500e18becc4f.ngrok-free.app",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36",
            "content-length": "3428",
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "content-type": "multipart/form-data; boundary=----WebKitFormBoundarycLfysy3i3X9mM9ch",
            "origin": "https://sonjie24.github.io",
            "priority": "u=1, i",
            "referer": "https://sonjie24.github.io/",
            "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Google Chrome\";v=\"138\"",
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": "\"Windows\"",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "cross-site",
            "x-forwarded-for": "210.5.107.106",
            "x-forwarded-host": "500e18becc4f.ngrok-free.app",
            "x-forwarded-proto": "https"
          },
          "params": {},
          "query": {},
          "body": {
            "uuid": "b88d0fe8-5927-41b7-84a3-eeb3c761777c",
            "type": "actual",
            "project": "CBMIS",
            "date_requested": "2025-07-15",
            "service_request_no": "Generating",
            "department": "OFFICE OF THE CITY CIVIL REGISTRAR",
            "module": "LCR",
            "system_form_name": "Death Report",
            "system_form_no": "CMIS00898",
            "concern_type_rev": "Yes",
            "priority_set": "Yes",
            "committed_date": "",
            "data_point": [
              "FUNCTION TO SEPARATE PRINT THE AGE BELLOW 18 yrs. old",
              "FUNCTION TO SEPARATE PRINT ALL THE RECIDENCE OF BOGO CITY ON DEATH REPORT"
            ],
            "reference_field": [
              "",
              ""
            ],
            "user": "Eva R. Laput",
            "user_id": "19",
            "department_head_id": "",
            "it_head_id": "",
            "integrator_id": "",
            "developer_id": "",
            "qa_id": "",
            "print_out_date": "",
            "system_print_date": "",
            "patch_date": "",
            "req_status": [
              "Pending"
            ],
            "cylix_status": [
              "Pending"
            ],
            "dev_status": [
              "Pending"
            ],
            "memo": [
              ""
            ]
          },
          "webhookUrl": "http://localhost:5678/webhook/create",
          "executionMode": "production"
        }
      }
    ],
    "get6": [
      {
        "json": {
          "headers": {
            "host": "f33f9373d24d.ngrok-free.app",
            "user-agent": "Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36 Edg/138.0.0.0",
            "content-length": "23",
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "content-type": "application/json",
            "origin": "http://127.0.0.1:5500",
            "priority": "u=1, i",
            "referer": "http://127.0.0.1:5500/",
            "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Microsoft Edge\";v=\"138\"",
            "sec-ch-ua-mobile": "?1",
            "sec-ch-ua-platform": "\"Android\"",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "cross-site",
            "x-forwarded-for": "180.190.187.34",
            "x-forwarded-host": "f33f9373d24d.ngrok-free.app",
            "x-forwarded-proto": "https"
          },
          "params": {},
          "query": {},
          "body": {
            "projectName": "CBMIS"
          },
          "webhookUrl": "http://localhost:5678/webhook/get-all",
          "executionMode": "production"
        }
      }
    ],
    "get3": [
      {
        "json": {
          "headers": {
            "host": "f33f9373d24d.ngrok-free.app",
            "user-agent": "Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36 Edg/138.0.0.0",
            "content-length": "23",
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "content-type": "application/json",
            "origin": "http://127.0.0.1:5500",
            "priority": "u=1, i",
            "referer": "http://127.0.0.1:5500/",
            "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Microsoft Edge\";v=\"138\"",
            "sec-ch-ua-mobile": "?1",
            "sec-ch-ua-platform": "\"Android\"",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "cross-site",
            "x-forwarded-for": "180.190.187.34",
            "x-forwarded-host": "f33f9373d24d.ngrok-free.app",
            "x-forwarded-proto": "https"
          },
          "params": {},
          "query": {},
          "body": {
            "projectName": "CBMIS"
          },
          "webhookUrl": "http://localhost:5678/webhook/get-all",
          "executionMode": "production"
        }
      }
    ],
    "Upload file": [
      {
        "json": {
          "kind": "drive#file",
          "id": "1fNwswNY5zIduXXpIWek5O9ecjnioYAXQ",
          "name": "Screenshot 2025-07-17 at 1.10.14PM.png",
          "mimeType": "image/png",
          "starred": false,
          "trashed": false,
          "explicitlyTrashed": false,
          "parents": [
            "1_pveRhn6VJoRmQP3LdSAP2K2I2oOeNZ5"
          ],
          "spaces": [
            "drive"
          ],
          "version": "2",
          "webContentLink": "https://drive.google.com/uc?id=1fNwswNY5zIduXXpIWek5O9ecjnioYAXQ&export=download",
          "webViewLink": "https://drive.google.com/file/d/1fNwswNY5zIduXXpIWek5O9ecjnioYAXQ/view?usp=drivesdk",
          "iconLink": "https://drive-thirdparty.googleusercontent.com/16/type/image/png",
          "hasThumbnail": true,
          "thumbnailLink": "https://lh3.googleusercontent.com/drive-storage/AJQWtBOECezQTsAgKu-P0k2qTQcnIAgghGDY49Du8o_R5NDpHUmu7AyVkQxbALR_uuR6oDUCXqtEn3TkXGL4UYrrYzzcjqTBdYXaoGwMOsaIIHCLnw=s220",
          "thumbnailVersion": "2",
          "viewedByMe": false,
          "createdTime": "2025-07-22T15:28:06.100Z",
          "modifiedTime": "2025-07-22T15:28:07.216Z",
          "modifiedByMeTime": "2025-07-22T15:28:07.216Z",
          "modifiedByMe": true,
          "owners": [
            {
              "kind": "drive#user",
              "displayName": "Mark Jayson",
              "photoLink": "https://lh3.googleusercontent.com/a/ACg8ocKkkgX3N__yyPetherv6QGyLoJ6U6Dv2rVjMyrWP4xHSBBJzg=s64",
              "me": true,
              "permissionId": "09844518454357450176",
              "emailAddress": "sonjie.ai@gmail.com"
            }
          ],
          "lastModifyingUser": {
            "kind": "drive#user",
            "displayName": "Mark Jayson",
            "photoLink": "https://lh3.googleusercontent.com/a/ACg8ocKkkgX3N__yyPetherv6QGyLoJ6U6Dv2rVjMyrWP4xHSBBJzg=s64",
            "me": true,
            "permissionId": "09844518454357450176",
            "emailAddress": "sonjie.ai@gmail.com"
          },
          "shared": true,
          "ownedByMe": true,
          "downloadRestrictions": {
            "itemDownloadRestriction": {
              "restrictedForReaders": false,
              "restrictedForWriters": false
            },
            "effectiveDownloadRestrictionWithContext": {
              "restrictedForReaders": false,
              "restrictedForWriters": false
            }
          },
          "capabilities": {
            "canAcceptOwnership": false,
            "canAddChildren": false,
            "canAddMyDriveParent": false,
            "canChangeCopyRequiresWriterPermission": true,
            "canChangeItemDownloadRestriction": true,
            "canChangeSecurityUpdateEnabled": false,
            "canChangeViewersCanCopyContent": true,
            "canComment": true,
            "canCopy": true,
            "canDelete": true,
            "canDisableInheritedPermissions": false,
            "canDownload": true,
            "canEdit": true,
            "canEnableInheritedPermissions": true,
            "canListChildren": false,
            "canModifyContent": true,
            "canModifyContentRestriction": true,
            "canModifyEditorContentRestriction": true,
            "canModifyOwnerContentRestriction": true,
            "canModifyLabels": false,
            "canMoveChildrenWithinDrive": false,
            "canMoveItemIntoTeamDrive": true,
            "canMoveItemOutOfDrive": true,
            "canMoveItemWithinDrive": true,
            "canReadLabels": false,
            "canReadRevisions": true,
            "canRemoveChildren": false,
            "canRemoveContentRestriction": false,
            "canRemoveMyDriveParent": true,
            "canRename": true,
            "canShare": true,
            "canTrash": true,
            "canUntrash": true
          },
          "viewersCanCopyContent": true,
          "copyRequiresWriterPermission": false,
          "writersCanShare": true,
          "permissions": [
            {
              "kind": "drive#permission",
              "id": "anyoneWithLink",
              "type": "anyone",
              "role": "reader",
              "allowFileDiscovery": false
            },
            {
              "kind": "drive#permission",
              "id": "09844518454357450176",
              "type": "user",
              "emailAddress": "sonjie.ai@gmail.com",
              "role": "owner",
              "displayName": "sonjie.ai",
              "deleted": false,
              "pendingOwner": false
            },
            {
              "kind": "drive#permission",
              "id": "13267826029103856043",
              "type": "user",
              "emailAddress": "n8n-342@n8n-ai-464508.iam.gserviceaccount.com",
              "role": "writer",
              "displayName": "n8n-342",
              "deleted": false,
              "pendingOwner": false
            }
          ],
          "permissionIds": [
            "anyoneWithLink",
            "09844518454357450176",
            "13267826029103856043"
          ],
          "originalFilename": "Untitled",
          "fullFileExtension": "png",
          "fileExtension": "png",
          "md5Checksum": "2d1fe7a7879e372abd50d5fd3cbc8cbe",
          "sha1Checksum": "7eab3a4266cbaf86e5ef300e7bf865c2f87e0b50",
          "sha256Checksum": "3dba4b50a447a91167efcb4cabdd03e43ea69ebb20f3a6ac6fcf17a94509d75b",
          "size": "166147",
          "quotaBytesUsed": "166147",
          "headRevisionId": "0B3bmwU2wW0aHYWZQK1FoWlNXUkdLclZBTEc4R01rQTdmSExzPQ",
          "imageMediaMetadata": {
            "width": 2850,
            "height": 812,
            "rotation": 0
          },
          "isAppAuthorized": true,
          "linkShareMetadata": {
            "securityUpdateEligible": false,
            "securityUpdateEnabled": true
          },
          "inheritedPermissionsDisabled": false
        }
      },
      {
        "json": {
          "kind": "drive#file",
          "id": "1KkupP10bssyK-fNbe5w5XAFo-kHebDNa",
          "name": "Screenshot 2025-07-17 at 8.01.42AM.png",
          "mimeType": "image/png",
          "starred": false,
          "trashed": false,
          "explicitlyTrashed": false,
          "parents": [
            "1_pveRhn6VJoRmQP3LdSAP2K2I2oOeNZ5"
          ],
          "spaces": [
            "drive"
          ],
          "version": "2",
          "webContentLink": "https://drive.google.com/uc?id=1KkupP10bssyK-fNbe5w5XAFo-kHebDNa&export=download",
          "webViewLink": "https://drive.google.com/file/d/1KkupP10bssyK-fNbe5w5XAFo-kHebDNa/view?usp=drivesdk",
          "iconLink": "https://drive-thirdparty.googleusercontent.com/16/type/image/png",
          "hasThumbnail": true,
          "thumbnailLink": "https://lh3.googleusercontent.com/drive-storage/AJQWtBMedK_0mc7A0b2u6CvUUTyj6c26PoyoPkewsMgjKU-_HQXbaiMv1pOTpIQXRf6sw-kINfrt93WWtuadwFhEGUWX3j1gPb4yRhyfzzCqKjm4ACA=s220",
          "thumbnailVersion": "2",
          "viewedByMe": false,
          "createdTime": "2025-07-22T15:28:10.132Z",
          "modifiedTime": "2025-07-22T15:28:11.564Z",
          "modifiedByMeTime": "2025-07-22T15:28:11.564Z",
          "modifiedByMe": true,
          "owners": [
            {
              "kind": "drive#user",
              "displayName": "Mark Jayson",
              "photoLink": "https://lh3.googleusercontent.com/a/ACg8ocKkkgX3N__yyPetherv6QGyLoJ6U6Dv2rVjMyrWP4xHSBBJzg=s64",
              "me": true,
              "permissionId": "09844518454357450176",
              "emailAddress": "sonjie.ai@gmail.com"
            }
          ],
          "lastModifyingUser": {
            "kind": "drive#user",
            "displayName": "Mark Jayson",
            "photoLink": "https://lh3.googleusercontent.com/a/ACg8ocKkkgX3N__yyPetherv6QGyLoJ6U6Dv2rVjMyrWP4xHSBBJzg=s64",
            "me": true,
            "permissionId": "09844518454357450176",
            "emailAddress": "sonjie.ai@gmail.com"
          },
          "shared": true,
          "ownedByMe": true,
          "downloadRestrictions": {
            "itemDownloadRestriction": {
              "restrictedForReaders": false,
              "restrictedForWriters": false
            },
            "effectiveDownloadRestrictionWithContext": {
              "restrictedForReaders": false,
              "restrictedForWriters": false
            }
          },
          "capabilities": {
            "canAcceptOwnership": false,
            "canAddChildren": false,
            "canAddMyDriveParent": false,
            "canChangeCopyRequiresWriterPermission": true,
            "canChangeItemDownloadRestriction": true,
            "canChangeSecurityUpdateEnabled": false,
            "canChangeViewersCanCopyContent": true,
            "canComment": true,
            "canCopy": true,
            "canDelete": true,
            "canDisableInheritedPermissions": false,
            "canDownload": true,
            "canEdit": true,
            "canEnableInheritedPermissions": true,
            "canListChildren": false,
            "canModifyContent": true,
            "canModifyContentRestriction": true,
            "canModifyEditorContentRestriction": true,
            "canModifyOwnerContentRestriction": true,
            "canModifyLabels": false,
            "canMoveChildrenWithinDrive": false,
            "canMoveItemIntoTeamDrive": true,
            "canMoveItemOutOfDrive": true,
            "canMoveItemWithinDrive": true,
            "canReadLabels": false,
            "canReadRevisions": true,
            "canRemoveChildren": false,
            "canRemoveContentRestriction": false,
            "canRemoveMyDriveParent": true,
            "canRename": true,
            "canShare": true,
            "canTrash": true,
            "canUntrash": true
          },
          "viewersCanCopyContent": true,
          "copyRequiresWriterPermission": false,
          "writersCanShare": true,
          "permissions": [
            {
              "kind": "drive#permission",
              "id": "anyoneWithLink",
              "type": "anyone",
              "role": "reader",
              "allowFileDiscovery": false
            },
            {
              "kind": "drive#permission",
              "id": "09844518454357450176",
              "type": "user",
              "emailAddress": "sonjie.ai@gmail.com",
              "role": "owner",
              "displayName": "sonjie.ai",
              "deleted": false,
              "pendingOwner": false
            },
            {
              "kind": "drive#permission",
              "id": "13267826029103856043",
              "type": "user",
              "emailAddress": "n8n-342@n8n-ai-464508.iam.gserviceaccount.com",
              "role": "writer",
              "displayName": "n8n-342",
              "deleted": false,
              "pendingOwner": false
            }
          ],
          "permissionIds": [
            "anyoneWithLink",
            "09844518454357450176",
            "13267826029103856043"
          ],
          "originalFilename": "Untitled",
          "fullFileExtension": "png",
          "fileExtension": "png",
          "md5Checksum": "b895d3986076f469af1de993be7424cd",
          "sha1Checksum": "c880daddcf162640d0d864df4b66524b18465a5f",
          "sha256Checksum": "065bee1f7b756a7bf2dcc2c1c8fd7356ce5944b6d86bd29d39ff3e88b6a55dd8",
          "size": "529908",
          "quotaBytesUsed": "529908",
          "headRevisionId": "0B3bmwU2wW0aHcFVNL1RRSE5KaUVLZnhLS3c3MjJQSGdnZSswPQ",
          "imageMediaMetadata": {
            "width": 2704,
            "height": 1516,
            "rotation": 0
          },
          "isAppAuthorized": true,
          "linkShareMetadata": {
            "securityUpdateEligible": false,
            "securityUpdateEnabled": true
          },
          "inheritedPermissionsDisabled": false
        }
      },
      {
        "json": {
          "kind": "drive#file",
          "id": "1O1qf9deQq5iAKNjNA1xZrK7j5dZCVu87",
          "name": "Screenshot 2025-07-19 at 11.32.11AM.png",
          "mimeType": "image/png",
          "starred": false,
          "trashed": false,
          "explicitlyTrashed": false,
          "parents": [
            "1_pveRhn6VJoRmQP3LdSAP2K2I2oOeNZ5"
          ],
          "spaces": [
            "drive"
          ],
          "version": "2",
          "webContentLink": "https://drive.google.com/uc?id=1O1qf9deQq5iAKNjNA1xZrK7j5dZCVu87&export=download",
          "webViewLink": "https://drive.google.com/file/d/1O1qf9deQq5iAKNjNA1xZrK7j5dZCVu87/view?usp=drivesdk",
          "iconLink": "https://drive-thirdparty.googleusercontent.com/16/type/image/png",
          "hasThumbnail": true,
          "thumbnailLink": "https://lh3.googleusercontent.com/drive-storage/AJQWtBPcNRue39hpxeF36AiqaH_JbF-zU_oJnA0tDAN_lEewqnZI8CGTh3VWKfUafvGyfkBNK9KN0glcFG1Vpafi0RqsL7lOBkyJRcGTtMi0wCbZew=s220",
          "thumbnailVersion": "2",
          "viewedByMe": false,
          "createdTime": "2025-07-22T15:28:12.735Z",
          "modifiedTime": "2025-07-22T15:28:13.834Z",
          "modifiedByMeTime": "2025-07-22T15:28:13.834Z",
          "modifiedByMe": true,
          "owners": [
            {
              "kind": "drive#user",
              "displayName": "Mark Jayson",
              "photoLink": "https://lh3.googleusercontent.com/a/ACg8ocKkkgX3N__yyPetherv6QGyLoJ6U6Dv2rVjMyrWP4xHSBBJzg=s64",
              "me": true,
              "permissionId": "09844518454357450176",
              "emailAddress": "sonjie.ai@gmail.com"
            }
          ],
          "lastModifyingUser": {
            "kind": "drive#user",
            "displayName": "Mark Jayson",
            "photoLink": "https://lh3.googleusercontent.com/a/ACg8ocKkkgX3N__yyPetherv6QGyLoJ6U6Dv2rVjMyrWP4xHSBBJzg=s64",
            "me": true,
            "permissionId": "09844518454357450176",
            "emailAddress": "sonjie.ai@gmail.com"
          },
          "shared": true,
          "ownedByMe": true,
          "downloadRestrictions": {
            "itemDownloadRestriction": {
              "restrictedForReaders": false,
              "restrictedForWriters": false
            },
            "effectiveDownloadRestrictionWithContext": {
              "restrictedForReaders": false,
              "restrictedForWriters": false
            }
          },
          "capabilities": {
            "canAcceptOwnership": false,
            "canAddChildren": false,
            "canAddMyDriveParent": false,
            "canChangeCopyRequiresWriterPermission": true,
            "canChangeItemDownloadRestriction": true,
            "canChangeSecurityUpdateEnabled": false,
            "canChangeViewersCanCopyContent": true,
            "canComment": true,
            "canCopy": true,
            "canDelete": true,
            "canDisableInheritedPermissions": false,
            "canDownload": true,
            "canEdit": true,
            "canEnableInheritedPermissions": true,
            "canListChildren": false,
            "canModifyContent": true,
            "canModifyContentRestriction": true,
            "canModifyEditorContentRestriction": true,
            "canModifyOwnerContentRestriction": true,
            "canModifyLabels": false,
            "canMoveChildrenWithinDrive": false,
            "canMoveItemIntoTeamDrive": true,
            "canMoveItemOutOfDrive": true,
            "canMoveItemWithinDrive": true,
            "canReadLabels": false,
            "canReadRevisions": true,
            "canRemoveChildren": false,
            "canRemoveContentRestriction": false,
            "canRemoveMyDriveParent": true,
            "canRename": true,
            "canShare": true,
            "canTrash": true,
            "canUntrash": true
          },
          "viewersCanCopyContent": true,
          "copyRequiresWriterPermission": false,
          "writersCanShare": true,
          "permissions": [
            {
              "kind": "drive#permission",
              "id": "anyoneWithLink",
              "type": "anyone",
              "role": "reader",
              "allowFileDiscovery": false
            },
            {
              "kind": "drive#permission",
              "id": "09844518454357450176",
              "type": "user",
              "emailAddress": "sonjie.ai@gmail.com",
              "role": "owner",
              "displayName": "sonjie.ai",
              "deleted": false,
              "pendingOwner": false
            },
            {
              "kind": "drive#permission",
              "id": "13267826029103856043",
              "type": "user",
              "emailAddress": "n8n-342@n8n-ai-464508.iam.gserviceaccount.com",
              "role": "writer",
              "displayName": "n8n-342",
              "deleted": false,
              "pendingOwner": false
            }
          ],
          "permissionIds": [
            "anyoneWithLink",
            "09844518454357450176",
            "13267826029103856043"
          ],
          "originalFilename": "Untitled",
          "fullFileExtension": "png",
          "fileExtension": "png",
          "md5Checksum": "08c0a2da89e0e7ecd5045f9b784a7c84",
          "sha1Checksum": "9f69db13d7e9f29ae35cbe0822fa9bc8044db278",
          "sha256Checksum": "521a09404ef6edda2e6c95a025f90a4cf1cd2bbcafcb054ecf2547c96cebc8c7",
          "size": "43357",
          "quotaBytesUsed": "43357",
          "headRevisionId": "0B3bmwU2wW0aHNVkrUE5MZEoySmVNU25UbEVabERzL204dmFJPQ",
          "imageMediaMetadata": {
            "width": 1832,
            "height": 576,
            "rotation": 0
          },
          "isAppAuthorized": true,
          "linkShareMetadata": {
            "securityUpdateEligible": false,
            "securityUpdateEnabled": true
          },
          "inheritedPermissionsDisabled": false
        }
      }
    ],
    "Merge": [
      {
        "json": {
          "id": "1oWbMkjZmkFfE43R3mtMTWV7WOhBvp_C5",
          "name": "68697543-ca5b-49cb-989d-ad9b46e85943"
        }
      }
    ],
    "Merge1": [
      {
        "json": {
          "headers": {
            "host": "500e18becc4f.ngrok-free.app",
            "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36",
            "content-length": "2320807",
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "content-type": "multipart/form-data; boundary=----WebKitFormBoundaryLrSnObF9wADdGtWU",
            "origin": "http://127.0.0.1:5500",
            "priority": "u=1, i",
            "referer": "http://127.0.0.1:5500/",
            "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Google Chrome\";v=\"138\"",
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": "\"macOS\"",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "cross-site",
            "x-forwarded-for": "222.127.239.246",
            "x-forwarded-host": "500e18becc4f.ngrok-free.app",
            "x-forwarded-proto": "https"
          },
          "params": {},
          "query": {},
          "body": {
            "uuid": "68697543-ca5b-49cb-989d-ad9b46e85943",
            "req_status": "For Head Approval",
            "type": "actual",
            "project": "CNIMS",
            "date_requested": "2025-07-24",
            "service_request_no": "CNIMS-2025-07-0001",
            "department": "Office of the City Treasurer",
            "module": "TREASURY",
            "system_form_name": "Check Disbursement",
            "system_form_no": "CMIS01101",
            "concern_type_rev": "Yes",
            "committed_date": "",
            "priority_immediate": "Yes",
            "data_point": "",
            "reference_field": "",
            "memo": "",
            "user": "Trina Litorja",
            "user_id": "",
            "department_head": "Trina Litorga",
            "department_head_id": "",
            "it_head": "Romeo B. Empleo Jr",
            "it_head_id": "",
            "integrator": "Joe Ann Resalina",
            "integrator_id": "",
            "developer": "Richard Porras",
            "developer_id": "",
            "qa": "N/A",
            "qa_id": "",
            "print_option_as_req": "Yes",
            "print_out_date": "2025-07-24",
            "system_print_date": "",
            "patch_date": ""
          },
          "webhookUrl": "http://localhost:5678/webhook/update",
          "executionMode": "production",
          "kind": "drive#file",
          "id": "1nyo699VtEFxfkVuWZ5vnQT7Nb02-gGB8",
          "name": "ChatGPT Image Jun 29, 2025, 03_21_29 PM.png",
          "mimeType": "image/png",
          "starred": false,
          "trashed": false,
          "explicitlyTrashed": false,
          "parents": [
            "1oWbMkjZmkFfE43R3mtMTWV7WOhBvp_C5"
          ],
          "spaces": [
            "drive"
          ],
          "version": "2",
          "webContentLink": "https://drive.google.com/uc?id=1nyo699VtEFxfkVuWZ5vnQT7Nb02-gGB8&export=download",
          "webViewLink": "https://drive.google.com/file/d/1nyo699VtEFxfkVuWZ5vnQT7Nb02-gGB8/view?usp=drivesdk",
          "iconLink": "https://drive-thirdparty.googleusercontent.com/16/type/image/png",
          "hasThumbnail": true,
          "thumbnailLink": "https://lh3.googleusercontent.com/drive-storage/AJQWtBN5M9f32mn6_guFVqnOXJGzlNhqkUt46BP3Lt86UGb25rY2vB6GOCdyZw45Mfja6iHWIqhzxrcHIYIzOhEwUVOS0jICPF05S21wS3Ztew6Ualk=s220",
          "thumbnailVersion": "2",
          "viewedByMe": false,
          "createdTime": "2025-07-25T07:55:33.860Z",
          "modifiedTime": "2025-07-25T07:55:35.430Z",
          "modifiedByMeTime": "2025-07-25T07:55:35.430Z",
          "modifiedByMe": true,
          "owners": [
            {
              "kind": "drive#user",
              "displayName": "Richard Porras",
              "photoLink": "https://lh3.googleusercontent.com/a/ACg8ocJDgRdCrVVPP1v6ZgQsYC-dXb_fRoc3dMQ7F1tNauZktu-t4Q=s64",
              "me": true,
              "permissionId": "08825313176171073356",
              "emailAddress": "devcode143@gmail.com"
            }
          ],
          "lastModifyingUser": {
            "kind": "drive#user",
            "displayName": "Richard Porras",
            "photoLink": "https://lh3.googleusercontent.com/a/ACg8ocJDgRdCrVVPP1v6ZgQsYC-dXb_fRoc3dMQ7F1tNauZktu-t4Q=s64",
            "me": true,
            "permissionId": "08825313176171073356",
            "emailAddress": "devcode143@gmail.com"
          },
          "shared": true,
          "ownedByMe": true,
          "downloadRestrictions": {
            "itemDownloadRestriction": {
              "restrictedForReaders": false,
              "restrictedForWriters": false
            },
            "effectiveDownloadRestrictionWithContext": {
              "restrictedForReaders": false,
              "restrictedForWriters": false
            }
          },
          "capabilities": {
            "canAcceptOwnership": false,
            "canAddChildren": false,
            "canAddMyDriveParent": false,
            "canChangeCopyRequiresWriterPermission": true,
            "canChangeItemDownloadRestriction": true,
            "canChangeSecurityUpdateEnabled": false,
            "canChangeViewersCanCopyContent": true,
            "canComment": true,
            "canCopy": true,
            "canDelete": true,
            "canDisableInheritedPermissions": false,
            "canDownload": true,
            "canEdit": true,
            "canEnableInheritedPermissions": true,
            "canListChildren": false,
            "canModifyContent": true,
            "canModifyContentRestriction": true,
            "canModifyEditorContentRestriction": true,
            "canModifyOwnerContentRestriction": true,
            "canModifyLabels": false,
            "canMoveChildrenWithinDrive": false,
            "canMoveItemIntoTeamDrive": true,
            "canMoveItemOutOfDrive": true,
            "canMoveItemWithinDrive": true,
            "canReadLabels": false,
            "canReadRevisions": true,
            "canRemoveChildren": false,
            "canRemoveContentRestriction": false,
            "canRemoveMyDriveParent": true,
            "canRename": true,
            "canShare": true,
            "canTrash": true,
            "canUntrash": true
          },
          "viewersCanCopyContent": true,
          "copyRequiresWriterPermission": false,
          "writersCanShare": true,
          "permissions": [
            {
              "kind": "drive#permission",
              "id": "anyoneWithLink",
              "type": "anyone",
              "role": "reader",
              "allowFileDiscovery": false
            },
            {
              "kind": "drive#permission",
              "id": "08825313176171073356",
              "type": "user",
              "emailAddress": "devcode143@gmail.com",
              "role": "owner",
              "displayName": "devcode143",
              "deleted": false,
              "pendingOwner": false
            }
          ],
          "permissionIds": [
            "anyoneWithLink",
            "08825313176171073356"
          ],
          "originalFilename": "Untitled",
          "fullFileExtension": "png",
          "fileExtension": "png",
          "md5Checksum": "1965bc2fe66becb9e84250b746a57346",
          "sha1Checksum": "b3e6cb0f83150fdac9e933a663957edca977a39d",
          "sha256Checksum": "e8916d711c60db5eb1c6c6fbffcefa99fd9df582d6599c3a762e62b8b7aa5d0a",
          "size": "2317197",
          "quotaBytesUsed": "2317197",
          "headRevisionId": "0B5vlCFyF3ifRaVpqUVY0Q214QmtpSEQ5SXYxNW1jdk9FM3lFPQ",
          "imageMediaMetadata": {
            "width": 1024,
            "height": 1536,
            "rotation": 0
          },
          "isAppAuthorized": true,
          "linkShareMetadata": {
            "securityUpdateEligible": false,
            "securityUpdateEnabled": true
          },
          "inheritedPermissionsDisabled": false
        }
      }
    ],
    "Webhook1": [
      {
        "json": {
          "headers": {
            "host": "500e18becc4f.ngrok-free.app",
            "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36",
            "content-length": "3590",
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "content-type": "multipart/form-data; boundary=----WebKitFormBoundaryuTY9rgM9MsrrAzt7",
            "origin": "http://127.0.0.1:5500",
            "priority": "u=1, i",
            "referer": "http://127.0.0.1:5500/",
            "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Google Chrome\";v=\"138\"",
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": "\"macOS\"",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "cross-site",
            "x-forwarded-for": "180.190.187.34",
            "x-forwarded-host": "500e18becc4f.ngrok-free.app",
            "x-forwarded-proto": "https"
          },
          "params": {},
          "query": {},
          "body": {
            "uuid": "27f256a1-18e6-48d7-82c7-6043gdgsde8b1gba11112",
            "type": "actual",
            "project": "CNIMS",
            "date_requested": "2025-07-27",
            "service_request_no": "CNIMS-2025-07-0004",
            "department": "Information Technology Center",
            "module": "ADMIN",
            "system_form_name": "Cancellation of Mayor`s Tricycle Permit",
            "system_form_no": "CMIS00025",
            "concern_type_new": "Yes",
            "concern_type_rev": "Yes",
            "committed_date": "",
            "data_point": "",
            "reference_field": "",
            "memo": "",
            "user": "Romeo B. Empleo Jr.",
            "user_id": "",
            "department_head": "Romeo B. Empleo Jr.",
            "department_head_id": "",
            "it_head": "Romeo B. Empleo Jr.",
            "it_head_id": "",
            "integrator": "Mark Jayson Ubas",
            "integrator_id": "1",
            "developer": "Lyngie Cansana",
            "developer_id": "2",
            "qa": "",
            "qa_id": "",
            "print_out_date": "",
            "system_print_date": "",
            "patch_date": "",
            "req_status": [
              "Approved"
            ],
            "cylix_status": [
              "Accepted"
            ]
          },
          "webhookUrl": "http://localhost:5678/webhook/update",
          "executionMode": "production"
        }
      }
    ],
    "webhook_get": [
      {
        "json": {
          "headers": {
            "host": "500e18becc4f.ngrok-free.app",
            "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36",
            "content-length": "110",
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "content-type": "application/json",
            "origin": "http://127.0.0.1:5500",
            "priority": "u=1, i",
            "referer": "http://127.0.0.1:5500/",
            "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Google Chrome\";v=\"138\"",
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": "\"macOS\"",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "cross-site",
            "x-forwarded-for": "180.190.188.71",
            "x-forwarded-host": "500e18becc4f.ngrok-free.app",
            "x-forwarded-proto": "https"
          },
          "params": {},
          "query": {},
          "body": {
            "user": {
              "userId": 27,
              "name": "Lyngie Cansana",
              "email": "markubas24@gmail.com",
              "department": "",
              "project": "CCMIS",
              "role": "Admin"
            }
          },
          "webhookUrl": "http://localhost:5678/webhook/get-all",
          "executionMode": "production"
        }
      }
    ],
    "webhook_get1": [
      {
        "json": {
          "headers": {
            "host": "500e18becc4f.ngrok-free.app",
            "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36",
            "content-length": "110",
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "content-type": "application/json",
            "origin": "http://127.0.0.1:5500",
            "priority": "u=1, i",
            "referer": "http://127.0.0.1:5500/",
            "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Google Chrome\";v=\"138\"",
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": "\"macOS\"",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "cross-site",
            "x-forwarded-for": "180.190.188.71",
            "x-forwarded-host": "500e18becc4f.ngrok-free.app",
            "x-forwarded-proto": "https"
          },
          "params": {},
          "query": {},
          "body": {
            "user": {
              "userId": 27,
              "name": "Lyngie Cansana",
              "email": "markubas24@gmail.com",
              "department": "",
              "project": "CCMIS",
              "role": "Admin"
            }
          },
          "webhookUrl": "http://localhost:5678/webhook/get-all",
          "executionMode": "production"
        }
      }
    ]
  },
  "connections": {
    "get detail": {
      "main": [
        [
          {
            "node": "Delete rows or columns from sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "get detail",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Delete rows or columns from sheet": {
      "main": [
        [
          {
            "node": "Respond to Webhook1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create folder": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge3": {
      "main": [
        [
          {
            "node": "Generate New Reference1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Last Reference1": {
      "main": [
        [
          {
            "node": "Merge3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate New Reference1": {
      "main": [
        [
          {
            "node": "Append row in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet1": {
      "main": [
        [
          {
            "node": "Aggregate1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload file1": {
      "main": [
        [
          {
            "node": "Merge4",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Split Binary Files1": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge2": {
      "main": [
        [
          {
            "node": "Upload file1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook2": {
      "main": [
        [
          {
            "node": "Extract Form Text",
            "type": "main",
            "index": 0
          },
          {
            "node": "Split Binary Files1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get Last Reference1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Data1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Create folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Form Text": {
      "main": [
        [
          {
            "node": "Merge3",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Append row in sheet3": {
      "main": [
        [
          {
            "node": "Aggregate1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out2": {
      "main": [
        [
          {
            "node": "Append row in sheet3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge4": {
      "main": [
        [
          {
            "node": "Split Out2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Data1": {
      "main": [
        [
          {
            "node": "Split Out3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out3": {
      "main": [
        [
          {
            "node": "Append row in sheet4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet4": {
      "main": [
        [
          {
            "node": "Aggregate1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate1": {
      "main": [
        [
          {
            "node": "Respond to Webhook2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Respond to Webhook3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Respond to Webhook4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Temp": {
      "main": [
        [
          {
            "node": "Merge5",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "3. Switch Node": {
      "main": [
        [
          {
            "node": "CNIMS",
            "type": "main",
            "index": 0
          },
          {
            "node": "Temp",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Temp",
            "type": "main",
            "index": 0
          },
          {
            "node": "CBMIS",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "CTMIS",
            "type": "main",
            "index": 0
          },
          {
            "node": "Temp",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Temp",
            "type": "main",
            "index": 0
          },
          {
            "node": "CCMIS1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Temp",
            "type": "main",
            "index": 0
          },
          {
            "node": "MDMIS",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "CYLIX",
            "type": "main",
            "index": 0
          },
          {
            "node": "Temp",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CNIMS": {
      "main": [
        [
          {
            "node": "Merge5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CBMIS": {
      "main": [
        [
          {
            "node": "Merge5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CTMIS": {
      "main": [
        [
          {
            "node": "Merge5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CCMIS1": {
      "main": [
        [
          {
            "node": "Merge5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MDMIS": {
      "main": [
        [
          {
            "node": "Merge5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CYLIX": {
      "main": [
        [
          {
            "node": "Merge5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook3": {
      "main": [
        [
          {
            "node": "3. Switch Node",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge5": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get": {
      "main": [
        [
          {
            "node": "get All7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get1": {
      "main": [
        [
          {
            "node": "get All8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get2": {
      "main": [
        [
          {
            "node": "get All9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get All7": {
      "main": [
        [
          {
            "node": "Respond to Webhook12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get All8": {
      "main": [
        [
          {
            "node": "Respond to Webhook13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get All9": {
      "main": [
        [
          {
            "node": "Respond to Webhook14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook4": {
      "main": [
        [
          {
            "node": "Delete a file",
            "type": "main",
            "index": 0
          },
          {
            "node": "get detail1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get detail1": {
      "main": [
        [
          {
            "node": "Delete rows or columns from sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Delete a file": {
      "main": [
        [
          {
            "node": "Respond to Webhook17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Delete rows or columns from sheet1": {
      "main": [
        [
          {
            "node": "Respond to Webhook17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get All12": {
      "main": [
        [
          {
            "node": "Code4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get5": {
      "main": [
        [
          {
            "node": "get All12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Respond to Webhook5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Respond to Webhook6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "3. Switch Node3": {
      "main": [
        [
          {
            "node": "CNIMS1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Temp1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "CBMIS1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Temp1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "CTMIS1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Temp1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "CCMIS",
            "type": "main",
            "index": 0
          },
          {
            "node": "Temp1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "MDMIS1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Temp1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "CYLIX1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Temp1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CNIMS1": {
      "main": [
        [
          {
            "node": "Merge6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CBMIS1": {
      "main": [
        [
          {
            "node": "Merge6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CTMIS1": {
      "main": [
        [
          {
            "node": "Merge6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CCMIS": {
      "main": [
        [
          {
            "node": "Merge6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MDMIS1": {
      "main": [
        [
          {
            "node": "Merge6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CYLIX1": {
      "main": [
        [
          {
            "node": "Merge6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook5": {
      "main": [
        [
          {
            "node": "3. Switch Node3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge6": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Temp1": {
      "main": [
        [
          {
            "node": "Merge6",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Code4": {
      "main": [
        [
          {
            "node": "Respond to Webhook18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get All18": {
      "main": [
        [
          {
            "node": "Code14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get6": {
      "main": [
        [
          {
            "node": "3. Switch Node4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code14": {
      "main": [
        [
          {
            "node": "Respond to Webhook31",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "3. Switch Node4": {
      "main": [
        [
          {
            "node": "get All18",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "get All19",
            "type": "main",
            "index": 0
          }
        ],
        [],
        [
          {
            "node": "get All11",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "get All13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get All19": {
      "main": [
        [
          {
            "node": "Code15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code15": {
      "main": [
        [
          {
            "node": "Respond to Webhook7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get All11": {
      "main": [
        [
          {
            "node": "Code16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code16": {
      "main": [
        [
          {
            "node": "Respond to Webhook8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get3": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code13": {
      "main": [
        [
          {
            "node": "Respond to Webhook30",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get All17": {
      "main": [
        [
          {
            "node": "Code13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get All13": {
      "main": [
        [
          {
            "node": "Code17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code17": {
      "main": [
        [
          {
            "node": "Respond to Webhook9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload file": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Split Binary Files": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Upload file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Form Text1": {
      "main": [
        [
          {
            "node": "Append or update row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Append row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Data": {
      "main": [
        [
          {
            "node": "Split Out1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out1": {
      "main": [
        [
          {
            "node": "Append row in sheet2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet2": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders": {
      "main": [
        [
          {
            "node": "Code1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append or update row in sheet": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge1": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook1": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Extract Form Text1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Split Binary Files",
            "type": "main",
            "index": 0
          },
          {
            "node": "Data",
            "type": "main",
            "index": 0
          },
          {
            "node": "Search files and folders",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders1": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code1": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If2": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Create folder1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create folder1": {
      "main": [
        [
          {
            "node": "Search files and folders1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "3. Switch Node1": {
      "main": [
        [
          {
            "node": "Code7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code8",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Respond to Webhook22",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code2": {
      "main": [
        [
          {
            "node": "Respond to Webhook23",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code3": {
      "main": [
        [
          {
            "node": "Respond to Webhook25",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code5": {
      "main": [
        [
          {
            "node": "Respond to Webhook21",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code6": {
      "main": [
        [
          {
            "node": "Respond to Webhook24",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code7": {
      "main": [
        [
          {
            "node": "Respond to Webhook19",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code8": {
      "main": [
        [
          {
            "node": "Respond to Webhook20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get All": {
      "main": [
        [
          {
            "node": "Merge7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get All1": {
      "main": [
        [
          {
            "node": "Merge7",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "get All2": {
      "main": [
        [
          {
            "node": "Merge7",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "webhook_get": {
      "main": [
        [
          {
            "node": "get All",
            "type": "main",
            "index": 0
          },
          {
            "node": "get All1",
            "type": "main",
            "index": 0
          },
          {
            "node": "get All2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge7",
            "type": "main",
            "index": 3
          }
        ]
      ]
    },
    "Merge7": {
      "main": [
        [
          {
            "node": "Code9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code9": {
      "main": [
        [
          {
            "node": "3. Switch Node1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "get All17",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "get All20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get All20": {
      "main": [
        [
          {
            "node": "Code13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "3. Switch Node2": {
      "main": [
        [
          {
            "node": "Code20",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code21",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code18",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code10",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code11",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code19",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code10": {
      "main": [
        [
          {
            "node": "Respond to Webhook29",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code11": {
      "main": [
        [
          {
            "node": "Respond to Webhook32",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code12": {
      "main": [
        [
          {
            "node": "Respond to Webhook34",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code18": {
      "main": [
        [
          {
            "node": "Respond to Webhook28",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code19": {
      "main": [
        [
          {
            "node": "Respond to Webhook33",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code20": {
      "main": [
        [
          {
            "node": "Respond to Webhook26",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code21": {
      "main": [
        [
          {
            "node": "Respond to Webhook27",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get All3": {
      "main": [
        [
          {
            "node": "Merge8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get All4": {
      "main": [
        [
          {
            "node": "Merge8",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "get All5": {
      "main": [
        [
          {
            "node": "Merge8",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "webhook_get1": {
      "main": [
        [
          {
            "node": "get All3",
            "type": "main",
            "index": 0
          },
          {
            "node": "get All4",
            "type": "main",
            "index": 0
          },
          {
            "node": "get All5",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge8",
            "type": "main",
            "index": 3
          }
        ]
      ]
    },
    "Merge8": {
      "main": [
        [
          {
            "node": "Code22",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code22": {
      "main": [
        [
          {
            "node": "3. Switch Node2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "560edc7c-8d49-4964-a95e-30d6869cc252",
  "meta": {
    "instanceId": "79ba0250104cb859eb8c1b1b109f0cc7dd733baeb546dc1733e16d3cfa2b8719"
  },
  "id": "9UOSXEAEKSQFaRa5",
  "tags": []
}